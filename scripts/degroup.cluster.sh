#!/bin/bash
#PBS -q home-yeo
#PBS -N degroupmeta
#PBS -l nodes=1:ppn=2
#PBS -l walltime=8:50:00
#PBS -o /home/hsher/cluster_msg/de.out
#PBS -e /home/hsher/cluster_msg/de.err
#PBS -t 0-123

source ~/miniconda3/etc/profile.d/conda.sh
conda activate metadensity


#rbps=(HNRNPC RBFOX2 IGF2BP1 HNRNPK SRSF7 IGF2BP3 TIA1 SRSF9 TRA2A IGF2BP1 HNRNPM FKBP4 HNRNPM IGF2BP2 SLTM SF3B4 BCCIP FMR1 FXR2 TRA2A U2AF2 LARP7 U2AF1 XRN2 HNRNPA1 HNRNPU SLTM CPSF6 EIF4G2 SLBP SAFB2 U2AF2 CSTF2T PRPF8 FAM120A HNRNPU U2AF1 HNRNPA1 TIA1 HNRNPUL1 PRPF8 CSTF2T FAM120A LARP7 SRSF1 SND1 XRCC6 SRSF1 FXR1 SND1 HNRNPUL1 LIN28B HNRNPK RBM22 ILF3 TAF15 TARDBP GTF2F1 SMNDC1 PCBP2 DDX3X SBDS KHDRBS1 NPM1 PTBP1 SRSF7 GTF2F1 LIN28B TAF15 SF3A3 NONO PABPC4 PPIL4 WRN AKAP8L SFPQ KHSRP EWSR1 PUM2 LSM11 SMNDC1 TROVE2 GPKOW NSUN2 FASTKD2 LARP4 FTO UPF1 QKI MTPAP UTP3 NCBP2 QKI XRCC6 DDX24 EXOSC5 DDX3X ILF3 RBM22 PPIG BUD13 RBM5 TROVE2 SF3B1 SF3B4 BUD13 METAP2 AATF RBM15 WDR43 HLTF RPS3 AGGF1 NOL12 AGGF1 DKC1 EIF3H NKRF ZRANB2 DDX55 RBM15 NOLC1 CDC40 LARP4 HNRNPL NCBP2 FUBP3 CSTF2 DROSHA DDX6 EFTUD2 TBRG4 DDX51 DDX6 LSM11 DDX55 GRSF1 DDX59 UCHL5 TBRG4 UTP18 AARS EIF3D GRWD1 UCHL5 EFTUD2 DDX52 BCLAF1 GRWD1 EIF3G FASTKD2 SUPV3L1 HLTF SUGP2 DHX30 XPO5 SUPV3L1 PUS1 AQR RBFOX2 GEMIN5 HNRNPL PHF6 DDX52 DHX30 ZC3H8 WDR3 UTP18 FUS PUM1 PCBP1 SERBP1 FUS MATR3 PTBP1 AKAP1 HNRNPC CPEB4 NIP7 AKAP1 G3BP1 MATR3 PCBP1 EXOSC5 FTO UPF1 SSB ABCF1 ZNF800 SSB SDAD1 SDAD1 SAFB PRPF4 TIAL1 KHSRP XRN2 DDX21 APOBEC3C SUB1 EEF2 DDX47 SRSF5 MBNL1 NPM1 TARDBP EEF2 NONO RPS10 EIF2S1 SRSF9 EIF4G1 EIF3A ADAR SNRNP200 SNRNP200 DDX1 DDX1 FXR1 HNRNPA0 NSUN2 TIAL1)
#celllines=(HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 K562 HepG2 HepG2 K562 K562 HepG2 HepG2 HepG2 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 HepG2 K562 K562 K562 HepG2 HepG2 HepG2 K562 K562 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 K562 K562 K562 HepG2 K562 K562 K562 K562 K562 K562 K562 HepG2 HepG2 K562 K562 K562 K562 K562 K562 HepG2 HepG2 HepG2 HepG2 K562 K562 K562 K562 K562 HepG2 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 HepG2 HepG2 K562 K562 K562 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 HepG2 HepG2 HepG2 HepG2 HepG2 K562 K562 HepG2 HepG2 HepG2 HepG2 K562 K562 HepG2 HepG2 HepG2 K562 K562 K562 K562 HepG2 HepG2 HepG2 HepG2 HepG2 K562 HepG2 HepG2 K562 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 K562 K562 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 K562 K562 K562 K562 K562 HepG2 K562 K562 K562 K562 K562 K562 K562 K562 HepG2 K562 HepG2 HepG2 HepG2 K562 K562 K562 HepG2 HepG2 HepG2 K562 K562 HepG2 HepG2 HepG2 HepG2 K562 K562 K562 K562 HepG2 K562 HepG2 HepG2 HepG2 HepG2 K562 K562 HepG2 K562 K562 K562 K562 HepG2 HepG2 HepG2 HepG2 K562 K562 K562 K562 K562 K562 K562 HepG2 K562 HepG2 HepG2 K562 HepG2 K562)

rbps=(HNRNPC RBFOX2 IGF2BP1 HNRNPK SRSF7 TIA1 SRSF9 TRA2A IGF2BP1 FKBP4 IGF2BP2 TRA2A LARP7 XRN2 HNRNPU SLTM EIF4G2 SLBP SAFB2 U2AF2 PRPF8 HNRNPU HNRNPA1 HNRNPUL1 PRPF8 FAM120A LARP7 SRSF1 XRCC6 FXR1 SND1 LIN28B HNRNPK ILF3 SBDS KHDRBS1 NPM1 LIN28B TAF15 NONO PPIL4 WRN KHSRP PUM2 LSM11 SMNDC1 TROVE2 NSUN2 FASTKD2 FTO QKI UTP3 QKI DDX3X TROVE2 METAP2 RPS3 AGGF1 NOL12 AGGF1 EIF3H DDX55 RBM15 NOLC1 CDC40 FUBP3 DROSHA EFTUD2 DDX51 LSM11 DDX55 UCHL5 AARS EIF3D GRWD1 EFTUD2 DDX52 BCLAF1 EIF3G SUPV3L1 SUPV3L1 PUS1 AQR RBFOX2 GEMIN5 HNRNPL PHF6 DDX52 DHX30 FUS PUM1 SERBP1 FUS AKAP1 HNRNPC CPEB4 NIP7 PCBP1 EXOSC5 SSB ABCF1 ZNF800 SSB SDAD1 SDAD1 TIAL1 KHSRP XRN2 DDX21 APOBEC3C EEF2 MBNL1 NPM1 EEF2 NONO RPS10 EIF2S1 SRSF9 EIF4G1 EIF3A SNRNP200 SNRNP200 DDX1 HNRNPA0)
celllines=(HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 HepG2 K562 HepG2 K562 K562 K562 K562 K562 K562 K562 K562 K562 HepG2 K562 HepG2 HepG2 K562 HepG2 HepG2 HepG2 HepG2 HepG2 K562 K562 K562 K562 K562 K562 K562 K562 HepG2 HepG2 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 K562 HepG2 HepG2 HepG2 K562 K562 K562 HepG2 HepG2 HepG2 K562 HepG2 HepG2 HepG2 HepG2 HepG2 K562 K562 HepG2 HepG2 K562 K562 HepG2 HepG2 HepG2 HepG2 HepG2 K562 HepG2 K562 K562 K562 K562 K562 HepG2 K562 K562 K562 K562 K562 K562 HepG2 K562 K562 K562 HepG2 K562 HepG2 HepG2 K562 K562 K562 K562 HepG2 HepG2 HepG2 HepG2 K562 K562 K562 K562 HepG2 HepG2 HepG2 K562 K562 K562 K562 K562 K562 HepG2 K562 K562)

rbp=${rbps[$PBS_ARRAYID]}
cellline=${celllines[$PBS_ARRAYID]}

python ~/Metadensity/scripts/degroup.py $rbp $cellline