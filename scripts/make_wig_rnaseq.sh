#!/bin/bash
#PBS -q home-yeo
#PBS -N DBSCAN_peak_ri
#PBS -l nodes=1:ppn=6
#PBS -l walltime=18:00:00
#PBS -o /home/hsher/cluster_msg/daparwig.out
#PBS -e /home/hsher/cluster_msg/daparwig.err
#PBS -t 0-199

module load bedtools
module load samtools

bams=(ENCFF469FSV ENCFF780LYQ ENCFF088WJW ENCFF272FNP ENCFF917QUS ENCFF630ZKL ENCFF722ZTS ENCFF550PNU ENCFF605MDF ENCFF271ABA ENCFF519CYF ENCFF359FKE ENCFF796JSX ENCFF874STK ENCFF185GLF ENCFF543CIU ENCFF567ICO ENCFF458KRT ENCFF202TKA ENCFF761YCL ENCFF665OLB ENCFF212WWN ENCFF196GZR ENCFF774WRR ENCFF949OZH ENCFF631CFD ENCFF580LGF ENCFF915WUU ENCFF734FHW ENCFF181APT ENCFF885WBL ENCFF011JXD ENCFF565WRF ENCFF058MXX ENCFF857MUO ENCFF008OKN ENCFF361LGV ENCFF285ELE ENCFF026SLE ENCFF562IQV ENCFF890NOM ENCFF208TBN ENCFF735CBR ENCFF913XJC ENCFF153ROK ENCFF647IUR ENCFF928GEG ENCFF476KOE ENCFF549ZVX ENCFF262VTJ ENCFF593VAX ENCFF443AJX ENCFF448BMO ENCFF146AIC ENCFF295YGW ENCFF810CQZ ENCFF276IWT ENCFF015RWL ENCFF925CTT ENCFF727EQB ENCFF852HQQ ENCFF956IBX ENCFF396QZZ ENCFF334QBK ENCFF031KTB ENCFF421NPZ ENCFF262RSX ENCFF553NAO ENCFF551UJF ENCFF310OHO ENCFF117KSL ENCFF432OJL ENCFF391OCV ENCFF319MJT ENCFF840ATK ENCFF636FCJ ENCFF403KGR ENCFF921YDI ENCFF045DRT ENCFF260OUK ENCFF992TTP ENCFF114TIS ENCFF664UFG ENCFF368DPO ENCFF122BHD ENCFF827FYP ENCFF810MHB ENCFF848WLR ENCFF467QHA ENCFF613QDI ENCFF934NGG ENCFF627XRL ENCFF088HUD ENCFF624WAO ENCFF936ZIY ENCFF451WIR ENCFF051CXY ENCFF373KKN ENCFF231QDM ENCFF311DCB ENCFF543EPJ ENCFF503JMW ENCFF837FNR ENCFF952CKH ENCFF883QEO ENCFF159KNS ENCFF698FUM ENCFF631HEW ENCFF743PNJ ENCFF387TRG ENCFF803UBO ENCFF544VWD ENCFF092OSB ENCFF443AOY ENCFF968NXH ENCFF401SJU ENCFF806UPC ENCFF629DXH ENCFF309PCT ENCFF912FLN ENCFF465XUK ENCFF575FWC ENCFF420XAQ ENCFF511YMI ENCFF714UIW ENCFF682XUU ENCFF873AKP ENCFF466EVT ENCFF109OEF ENCFF545JRU ENCFF591AHP ENCFF894EOF ENCFF915OWV ENCFF328GAZ ENCFF275TGS ENCFF400VDZ ENCFF673GAB ENCFF289TTH ENCFF437QEA ENCFF453CWB ENCFF754GHW ENCFF076HKP ENCFF428OGQ ENCFF597JUZ ENCFF558WTK ENCFF782WLK ENCFF946NGE ENCFF655GRA ENCFF197CGS ENCFF654FMQ ENCFF550BDH ENCFF198FDG ENCFF575EZY ENCFF560KLF ENCFF632KHF ENCFF412KKQ ENCFF155EDI ENCFF627XLB ENCFF994KLD ENCFF052YSS ENCFF810PHY ENCFF900KDZ ENCFF891JDX ENCFF612FZL ENCFF764AHF ENCFF644FZX ENCFF142MNV ENCFF122VBO ENCFF625CKI ENCFF764HLG ENCFF771AHF ENCFF583JDB ENCFF894TVP ENCFF383DKD ENCFF924OPX ENCFF617HRK ENCFF153VYI ENCFF549AUI ENCFF842AXS ENCFF247CLK ENCFF370DLR ENCFF785PHX ENCFF743GZQ ENCFF452EMG ENCFF908KNL ENCFF907YWP ENCFF652GWU ENCFF924TTV ENCFF085XBF ENCFF945HAL ENCFF562KRN ENCFF984MME ENCFF077CWW ENCFF799XRW ENCFF407ZEZ ENCFF625QXU ENCFF954OBF ENCFF330CHV ENCFF798RSV ENCFF923DHP ENCFF345BJV ENCFF822DIA ENCFF131YVK ENCFF944XRF ENCFF935TXK ENCFF989TMS ENCFF752MBC ENCFF675GOT ENCFF839XZI ENCFF755BAZ ENCFF044JDG ENCFF051CAG ENCFF155ZJN ENCFF132IOH ENCFF703LMN ENCFF782JJL ENCFF919WVS ENCFF369SFS ENCFF220MWM ENCFF816LBP ENCFF601RTZ ENCFF184EXQ ENCFF285BET ENCFF721YQT ENCFF044OKC ENCFF713TPG ENCFF744KGM ENCFF698JGB ENCFF652TWL ENCFF135URE ENCFF103VZY ENCFF494QFX ENCFF412TXK ENCFF951ZGS ENCFF968MUN ENCFF459FPU ENCFF721DJW ENCFF189WJH ENCFF181IAL ENCFF554QEV ENCFF838ARB ENCFF745OSA ENCFF037CUC ENCFF948RXH ENCFF233YFQ ENCFF683EXE ENCFF496TLV ENCFF172VDZ ENCFF698HGN ENCFF222CYM ENCFF988HCD ENCFF039EFY ENCFF994UAY ENCFF217XPV ENCFF309RQX ENCFF761SAC ENCFF693KHW ENCFF296IYJ ENCFF619EBQ ENCFF974PYS ENCFF488WGA ENCFF161EYD ENCFF572PAW ENCFF928FXN ENCFF198BST ENCFF196SQK ENCFF138PSI ENCFF390TYO ENCFF948LBQ ENCFF169UXZ ENCFF252LJU ENCFF580VRV ENCFF430YLM ENCFF995JDI ENCFF542MIC ENCFF468TYN ENCFF702XXC ENCFF118JRL ENCFF103CZK ENCFF741NGC ENCFF141OPU ENCFF577OGZ ENCFF367XTR ENCFF787CCQ ENCFF918BEC ENCFF808YTE ENCFF116ERZ ENCFF103RQT ENCFF158ITX ENCFF197UJB ENCFF361YGH ENCFF434OHR ENCFF652UUW ENCFF430UYO ENCFF107HBR ENCFF111AGW ENCFF297FRG ENCFF933YGM ENCFF562SON ENCFF087WDY ENCFF226GMB ENCFF781LCV ENCFF431LMX ENCFF872RJJ ENCFF642JIT ENCFF289WRI ENCFF379QMM ENCFF888UOD ENCFF076OKU ENCFF606LIW ENCFF234KAR ENCFF877VVK ENCFF048HAN ENCFF571HCE ENCFF560FIY ENCFF615KJS ENCFF985VTH ENCFF185OGI ENCFF500CQP ENCFF583XQP ENCFF396RUH ENCFF699CFB ENCFF899HDD ENCFF029KKT ENCFF058KYW ENCFF633EDM ENCFF921OOX ENCFF640DAQ ENCFF722ZRT ENCFF642PWD ENCFF072YMB ENCFF672FGY ENCFF469RPC ENCFF801QCZ ENCFF377ZTK ENCFF740FMQ ENCFF404KTE ENCFF031MBG ENCFF728OBP ENCFF084BRC ENCFF568KAD ENCFF796SGY ENCFF633QJY ENCFF224UNS ENCFF782MDE ENCFF730SRO ENCFF547ZBH ENCFF124XRR ENCFF836OGF ENCFF477PXW ENCFF725OSR ENCFF020ATL ENCFF998XFR ENCFF253HMW ENCFF275NYS ENCFF629AWY ENCFF061UBO ENCFF173FEQ ENCFF390MIX ENCFF541AVR ENCFF278QHX ENCFF055EEK ENCFF955KYN ENCFF880DNL ENCFF764KJW ENCFF366TBR ENCFF752OWX ENCFF601NJD ENCFF505IWI ENCFF816RGM ENCFF387QCB ENCFF591RQE ENCFF067WKG ENCFF717LFC ENCFF414CZS ENCFF701STP ENCFF018KJO ENCFF014TBH ENCFF650ZEJ ENCFF610AAZ ENCFF095ZAS ENCFF459YCM ENCFF744WGZ ENCFF410LSF ENCFF180TRV ENCFF260JUT ENCFF813JIZ ENCFF540PAV ENCFF072BEG ENCFF035QOQ ENCFF192YYQ ENCFF503HFA ENCFF815NQY ENCFF579QKT ENCFF215QMS ENCFF512KLH ENCFF730DLV ENCFF747RMM ENCFF900FTG ENCFF633KFU ENCFF269ZVZ ENCFF889MBK ENCFF288JEN ENCFF481NZE ENCFF482TPJ ENCFF031UPH ENCFF958HCI ENCFF790EAK ENCFF883PJY ENCFF339KJJ ENCFF172SRF ENCFF615MUQ ENCFF021NQD ENCFF746LSF ENCFF529TIM ENCFF274CSJ ENCFF110BVT ENCFF201UHZ ENCFF574REP ENCFF686SLR ENCFF646QVE ENCFF731OEM ENCFF361KUQ ENCFF746QLL ENCFF533SIN ENCFF839QHL ENCFF678KJA ENCFF004ORO ENCFF581FAG ENCFF070OJW ENCFF600JAO ENCFF194RBA ENCFF420VMT ENCFF669EEP ENCFF717MME ENCFF279PQZ ENCFF850EIP ENCFF651OSW ENCFF167OCW ENCFF488IAM ENCFF139IFY ENCFF451GID ENCFF512ELZ ENCFF656TLE ENCFF870ZRZ ENCFF392HZK ENCFF350AXZ ENCFF363ZON ENCFF958NOA ENCFF566LUZ ENCFF058VTG ENCFF392KBU ENCFF220WVI ENCFF161LUA ENCFF044SSS ENCFF242VQJ ENCFF623UWZ ENCFF991MEC ENCFF046OMI ENCFF073NAB ENCFF362TLS ENCFF842TKX ENCFF149SHU ENCFF358AQL ENCFF991PNX ENCFF393LTX ENCFF079AYK ENCFF377TXZ ENCFF630LXE ENCFF994YDH ENCFF206UTF ENCFF139WRA ENCFF053OCI ENCFF622FID ENCFF214KGP ENCFF436PXG ENCFF425LJJ ENCFF520QIL ENCFF990XDZ ENCFF411QXQ ENCFF830AFM ENCFF606AVE ENCFF864WXU ENCFF627RDN ENCFF751QEH ENCFF800PCX ENCFF134OIU ENCFF709JYV ENCFF101BJR ENCFF741FHY ENCFF060VSE ENCFF958GEJ ENCFF094DSM ENCFF829HUU ENCFF638JCM ENCFF187WJT ENCFF289HFR ENCFF740UYB ENCFF608RJT ENCFF754DEJ ENCFF279WLO ENCFF101YXQ ENCFF919WYI ENCFF731IFF ENCFF202OKI ENCFF508UPR ENCFF043BSV ENCFF315XSA ENCFF847YMN ENCFF442APZ ENCFF556NPQ ENCFF640DZK ENCFF533VDU ENCFF624NBF ENCFF101CJL ENCFF688ORJ ENCFF879MSU ENCFF799YPD ENCFF268SDJ ENCFF827WGG ENCFF624LCT ENCFF207XGV ENCFF472EMZ ENCFF749IYE ENCFF771TRQ ENCFF751ITZ ENCFF345BNB ENCFF121JCX ENCFF951MYQ ENCFF822TQT ENCFF502KMO ENCFF942XPX ENCFF724DDK ENCFF086ZCL ENCFF411JUJ ENCFF246XIT ENCFF694DXD ENCFF593SNU ENCFF539VZC ENCFF870COS ENCFF345XRH ENCFF969KZK ENCFF350NSR ENCFF641OYB ENCFF232HCC ENCFF996LET ENCFF296FHU ENCFF211VLH ENCFF631ZMF ENCFF417AVO ENCFF534VDO ENCFF425BAT ENCFF889FRC ENCFF622ULI ENCFF758TRE ENCFF144WCH ENCFF063DVX ENCFF818BNM ENCFF029FHI ENCFF935KUC ENCFF882KNZ ENCFF885OGZ ENCFF930UIK ENCFF824LLT ENCFF102THE ENCFF743XCK ENCFF296TTJ ENCFF300GUU ENCFF519FBY ENCFF834BBD ENCFF905QOO ENCFF086DTK ENCFF006DJB ENCFF737ISE ENCFF960BRU ENCFF409WZH ENCFF919OFB ENCFF686LKD ENCFF665WMD ENCFF271ZYT ENCFF363ASO ENCFF768KJN ENCFF859QBQ ENCFF522YID ENCFF349HFT ENCFF124BQH ENCFF466CKO ENCFF427NTF ENCFF671TGN ENCFF614HPB ENCFF581YTW ENCFF291ERF ENCFF695SSC ENCFF961DCD ENCFF796RYI ENCFF721JAR ENCFF665RGY ENCFF882JCW ENCFF111LSY ENCFF843KJF ENCFF009MBZ ENCFF396WPA ENCFF876NAI ENCFF275GXI ENCFF867FKK ENCFF344VNM ENCFF594IZP ENCFF253RJD ENCFF860DAE ENCFF311TMC ENCFF769NTH ENCFF452BKI ENCFF663VXW ENCFF072KHY ENCFF359ZQU ENCFF364LVH ENCFF822TUL ENCFF069VOQ ENCFF309MRQ ENCFF639EMO ENCFF255WZZ ENCFF273IEO ENCFF237MCF ENCFF372VZN ENCFF256ZZG ENCFF541QPD ENCFF036OHN ENCFF595OBA ENCFF238JUN ENCFF049DFS ENCFF730PVD ENCFF086SXC ENCFF973BAQ ENCFF167HPP ENCFF499WOR ENCFF521BXO ENCFF838XHX ENCFF119QUB ENCFF099ZHQ ENCFF451TLM ENCFF674KPG ENCFF246LZZ ENCFF876ERJ ENCFF187PGH ENCFF840EFF ENCFF855EBT ENCFF902RZF ENCFF454VQW ENCFF574CZD ENCFF725YFX ENCFF940WSQ ENCFF071RFP ENCFF164XBY ENCFF062UFO ENCFF929WVZ ENCFF150DQE ENCFF203WMA ENCFF898NIJ ENCFF369XSP ENCFF675UCS ENCFF721WCK ENCFF836KMF ENCFF102ZKG ENCFF305XBZ ENCFF468MSZ ENCFF516WEP ENCFF324GVC ENCFF732FSX ENCFF380OYY ENCFF058VYJ ENCFF909UYT ENCFF971DMX ENCFF673CAH ENCFF176FHW ENCFF494YCT ENCFF128CIF ENCFF373FWY ENCFF624URW ENCFF516KCI ENCFF762BSV ENCFF384PMZ ENCFF617TFJ ENCFF284NQQ ENCFF569QEZ ENCFF580BXZ ENCFF422YHM ENCFF969IDX ENCFF003KXY ENCFF132SHU ENCFF780OXE ENCFF318HIB ENCFF771HJQ ENCFF337BXS ENCFF611CLD ENCFF609FZS ENCFF592GCC ENCFF311XME ENCFF970LKG ENCFF808WAQ ENCFF979BGR ENCFF148IZQ ENCFF713ZMQ ENCFF152SSV ENCFF036KPI ENCFF844FNN ENCFF332APE ENCFF998QZZ ENCFF286MAR ENCFF211VPS ENCFF605GQB ENCFF768YMX ENCFF610HPU ENCFF151ZEL ENCFF996YRH ENCFF039VBF ENCFF116UEK ENCFF985QNQ ENCFF081IUU ENCFF251AHM ENCFF875ZVH ENCFF256UVZ ENCFF314LOA ENCFF311ESK ENCFF722ZUO ENCFF059VDA ENCFF778AZZ ENCFF396YDD ENCFF079UCH ENCFF254ISN ENCFF068LRE ENCFF008LKR ENCFF619SSA ENCFF612TNR ENCFF901EGK ENCFF598ZGR ENCFF694JWV ENCFF854PFR ENCFF756HIE ENCFF940XUO ENCFF376WQN ENCFF072KAU ENCFF842XKM ENCFF981ZYP ENCFF032HRO ENCFF371SPX ENCFF731UBI ENCFF287GNK ENCFF058BCD ENCFF253KKR ENCFF407RUC ENCFF807EPF ENCFF700TTY ENCFF782OAU ENCFF101BXP ENCFF956DKX ENCFF205KBS ENCFF171TTJ ENCFF553ICC ENCFF216ABM ENCFF351XXC ENCFF191YTI ENCFF997NRL ENCFF255SHL ENCFF968SOS ENCFF462NSJ ENCFF878DWG ENCFF241YUC ENCFF927NOX ENCFF670UJI ENCFF288ZFC ENCFF867NHV ENCFF718YCG ENCFF020BLN ENCFF851IUJ ENCFF501COM ENCFF269FXX ENCFF986NRO ENCFF769YLX ENCFF295CFK ENCFF858XNX ENCFF670LRD ENCFF056XPQ ENCFF431ARJ ENCFF236UHC ENCFF831BIQ ENCFF539BHR ENCFF618APB ENCFF121NYE ENCFF512SXV ENCFF034JWJ ENCFF487HDO ENCFF496ABP ENCFF127QPD ENCFF485FVD ENCFF789VGM ENCFF872PTD ENCFF684CIL ENCFF587KKY ENCFF593ICV ENCFF124IGD ENCFF074QTM ENCFF407RBD ENCFF889ZJT ENCFF333QYQ ENCFF073QWS ENCFF182JXJ ENCFF752QBE ENCFF716YLR ENCFF680YWG ENCFF957TLS ENCFF742IUO ENCFF391EIB ENCFF764NQK ENCFF895YXH ENCFF511SHN ENCFF201FDG ENCFF745XZP ENCFF596NAC ENCFF008KSQ ENCFF038NBJ ENCFF842IDK ENCFF920TDC ENCFF833WEC ENCFF767VDD ENCFF124CQD ENCFF151DJX ENCFF460YJY ENCFF332CHF ENCFF203SIQ ENCFF822LMS ENCFF368WCW ENCFF997NWS ENCFF703WDK ENCFF579JBI ENCFF906CAC ENCFF904USC ENCFF988EGT ENCFF708QSG ENCFF902YHV ENCFF541IMJ ENCFF584IWV ENCFF058FIU ENCFF527SUH ENCFF513STE ENCFF568DGW ENCFF446FTR ENCFF634HKB ENCFF813YZF ENCFF326BPV ENCFF717DRU ENCFF861NSL ENCFF052JGS ENCFF134ZUW ENCFF812WSU ENCFF224RNR ENCFF676JGE ENCFF016KQV ENCFF081JHI ENCFF052UJN ENCFF942FAX ENCFF959WPL ENCFF259ZYJ ENCFF874HKS ENCFF514OEF ENCFF098IMS ENCFF178PGE ENCFF611HGV ENCFF225TRZ ENCFF202ZWS ENCFF467VAU ENCFF940DPT ENCFF202RTM ENCFF995EQN ENCFF012NGD ENCFF121YTF ENCFF601OFM ENCFF449HAZ ENCFF130KNV ENCFF415JWM ENCFF312GRW ENCFF940WWC ENCFF325KNC ENCFF823IDH ENCFF686VXI ENCFF775HZV ENCFF809ILK ENCFF999SUM ENCFF337MIF ENCFF902TQC ENCFF601IUN ENCFF224TGR ENCFF158TJL ENCFF520WPX ENCFF557HSG ENCFF478ZKI ENCFF842IKX ENCFF018TYT ENCFF491XQX ENCFF826NMS ENCFF709OYR ENCFF656YKZ ENCFF082JJQ ENCFF558KIA ENCFF507BXE ENCFF589LNN ENCFF895JXN ENCFF259WLS ENCFF163OUK ENCFF255RKE ENCFF170JPI ENCFF392PRG ENCFF507LJA ENCFF466BYB ENCFF187NWM ENCFF897XWY ENCFF887KLE ENCFF691JCT ENCFF870KFE ENCFF911NYK ENCFF061ADN ENCFF340UFH ENCFF596OUL ENCFF211UDA ENCFF876FXL ENCFF076AFB ENCFF902IHE ENCFF858LPO ENCFF327FQO ENCFF111NRZ ENCFF185IAD ENCFF722KHW ENCFF323ZKA ENCFF802WRI ENCFF954ZEF ENCFF244ZQM ENCFF217CYB ENCFF385HEX ENCFF576SLW ENCFF483FOU ENCFF314JCM ENCFF772JIO ENCFF409SBC ENCFF311VYO ENCFF605AHY ENCFF350YQV ENCFF791OAS ENCFF956SFY ENCFF871MMC ENCFF427FYZ ENCFF744GRY ENCFF495RBD ENCFF046ENG ENCFF970YIB ENCFF279RET ENCFF078LXU ENCFF964OHS ENCFF008OMX ENCFF555VXW ENCFF627EBI ENCFF754BYO ENCFF930DYT ENCFF636CZX ENCFF550XIC ENCFF370FDT ENCFF662XNN ENCFF519AHH ENCFF574CEC ENCFF732IVH ENCFF471PNG ENCFF749AZU ENCFF658DCV ENCFF318FCO ENCFF472JQQ ENCFF652GAC ENCFF964NLY ENCFF344SLU ENCFF371TBZ ENCFF360UZH ENCFF451PMF ENCFF549RAR ENCFF218ZII ENCFF131BCB ENCFF544OPF ENCFF519WJE ENCFF423FQX ENCFF812AEQ ENCFF195NPE ENCFF264PKQ ENCFF040XPE ENCFF592JWO ENCFF357UJY ENCFF183AHH ENCFF590QAL ENCFF449XHR ENCFF033BYF ENCFF367IXJ ENCFF126ZCQ ENCFF008VSN ENCFF020FNS ENCFF209BIZ ENCFF737FSA ENCFF193YBH ENCFF456VWU ENCFF881QUW ENCFF920LKB ENCFF367NCV ENCFF586QOM ENCFF331PYA ENCFF919UOJ ENCFF115THD ENCFF402XUP ENCFF215GNR ENCFF171BBA ENCFF421LNM ENCFF156XKW ENCFF036JKE ENCFF033BTT ENCFF367YRD ENCFF398WLJ ENCFF197QFK ENCFF588RXP ENCFF171YKW ENCFF048WFR ENCFF307SBE ENCFF829SXA ENCFF564RGD ENCFF372AFS ENCFF256VYT ENCFF002RWS ENCFF055JUC ENCFF402MEI ENCFF309WYI ENCFF593OEF ENCFF321DPA ENCFF290NJD ENCFF202DAN ENCFF792AUU ENCFF803SMF ENCFF835PQD ENCFF221RXA ENCFF831MHS ENCFF727DQZ ENCFF727PTE ENCFF749TKX ENCFF320LOZ ENCFF027KSG ENCFF978PEN ENCFF820TIZ ENCFF224KIJ ENCFF652GQO ENCFF890QDC ENCFF714WXH ENCFF506LOF ENCFF338PHG ENCFF687AGZ ENCFF324AFT ENCFF030MRS ENCFF415ANM ENCFF839SZZ)

indir=/projects/ps-yeolab5/encode/rnaseq/shrna_knockdown/
outdir=/projects/ps-yeolab5/encode/rnaseq/shrna_knockdown/wig/
mappedreads=readdepth.txt

touch $outdir$mappedreads

bam=${bams[$PBS_ARRAYID]}

samtools index $indir$bam.bam
bedtools genomecov -ibam $indir$bam.bam -bga -split -trackline > $outdir$bam.wig
mapped=$(samtools view -c -F 260 $indir$bam.bam)
echo -e $indir$bam.bam $mapped >> $outdir$mappedreads

bam=${bams[$PBS_ARRAYID+200]}

samtools index $indir$bam.bam
bedtools genomecov -ibam $indir$bam.bam -bga -split -trackline > $outdir$bam.wig
mapped=$(samtools view -c -F 260 $indir$bam.bam)
echo -e $indir$bam.bam $mapped >> $outdir$mappedreads

bam=${bams[$PBS_ARRAYID+400]}

samtools index $indir$bam.bam
bedtools genomecov -ibam $indir$bam.bam -bga -split -trackline > $outdir$bam.wig
mapped=$(samtools view -c -F 260 $indir$bam.bam)
echo -e $indir$bam.bam $mapped >> $outdir$mappedreads

bam=${bams[$PBS_ARRAYID+600]}

samtools index $indir$bam.bam
bedtools genomecov -ibam $indir$bam.bam -bga -split -trackline > $outdir$bam.wig
mapped=$(samtools view -c -F 260 $indir$bam.bam)
echo -e $indir$bam.bam $mapped >> $outdir$mappedreads

bam=${bams[$PBS_ARRAYID+800]}

samtools index $indir$bam.bam
bedtools genomecov -ibam $indir$bam.bam -bga -split -trackline > $outdir$bam.wig
mapped=$(samtools view -c -F 260 $indir$bam.bam)
echo -e $indir$bam.bam $mapped >> $outdir$mappedreads

bam=${bams[$PBS_ARRAYID+1000]}

samtools index $indir$bam.bam
bedtools genomecov -ibam $indir$bam.bam -bga -split -trackline > $outdir$bam.wig
mapped=$(samtools view -c -F 260 $indir$bam.bam)
echo -e $indir$bam.bam $mapped >> $outdir$mappedreads

