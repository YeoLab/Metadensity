#!/bin/bash
#PBS -q home-yeo
#PBS -N DBSCAN_peak
#PBS -l nodes=1:ppn=6
#PBS -l walltime=8:00:00
#PBS -o /home/hsher/cluster_msg/dbscan.out
#PBS -e /home/hsher/cluster_msg/dbscan.err
#PBS -t 0-198

source ~/miniconda3/etc/profile.d/conda.sh
#conda activate metadensity


names=(203_HNRNPC_HepG2 204_RBFOX2_HepG2 205_IGF2BP1_HepG2 206_HNRNPK_HepG2 211_IGF2BP3_HepG2 215_TIA1_HepG2 216_SRSF9_HepG2 218_TRA2A_HepG2 220_IGF2BP1_K562 222_HNRNPM_HepG2 223_FKBP4_HepG2 224_HNRNPM_K562 226_IGF2BP2_K562 227_SLTM_HepG2 228_SF3B4_HepG2 230_BCCIP_HepG2 236_FMR1_K562 240_TRA2A_K562 241_DDX42_K562 242_U2AF2_K562 243_LARP7_K562 244_U2AF1_K562 245_XRN2_K562 247_HNRNPA1_K562 249_HNRNPU_K562 256_SLTM_K562 258_CPSF6_K562 260_EIF4G2_K562 262_SLBP_K562 267_SAFB2_K562 272_U2AF2_HepG2 275_CSTF2T_K562 278_PRPF8_K562 279_FAM120A_K562 281_HNRNPU_HepG2 283_HNRNPA1_HepG2 285_TIA1_K562 289_HNRNPUL1_K562 291_PRPF8_HepG2 292_CSTF2T_HepG2 297_FAM120A_HepG2 301_SRSF1_HepG2 302_SND1_HepG2 311_XRCC6_HepG2 312_SRSF1_K562 315_FXR1_K562 316_SND1_K562 321_HNRNPUL1_HepG2 325_LIN28B_K562 326_HNRNPK_K562 331_RBM22_K562 338_ILF3_K562 339_TAF15_K562 340_TARDBP_K562 341_DGCR8_K562 342_GTF2F1_K562 344_SMNDC1_HepG2 345_PCBP2_HepG2 350_DDX3X_K562 352_SBDS_K562 353_KHDRBS1_K562 354_NPM1_K562 358_GNL3_K562 367_YWHAG_K562 368_PTBP1_K562 376_SRSF7_K562 383_DGCR8_HepG2 384_GTF2F1_HepG2 387_LIN28B_HepG2 393_SF3A3_HepG2 405_NONO_K562 406_PABPC4_K562 414_PPIL4_K562 416_WRN_K562 437_SFPQ_HepG2 439_KHSRP_K562 440_EWSR1_K562 441_PUM2_K562 445_SMNDC1_K562 447_TROVE2_K562 450_GPKOW_K562 452_NSUN2_K562 460_FASTKD2_K562 464_FTO_K562 465_UPF1_K562 466_QKI_K562 470_MTPAP_K562 475_UTP3_K562 477_NCBP2_HepG2 478_QKI_HepG2 480_XRCC6_K562 481_DROSHA_K562 483_DDX24_K562 491_EXOSC5_K562 492_DDX3X_HepG2 493_ILF3_HepG2 494_RBM22_HepG2 495_PPIG_HepG2 501_RBM5_HepG2 503_TROVE2_HepG2 506_SF3B1_K562 507_SF3B4_K562 508_BUD13_K562 511_AATF_K562 514_RBM15_K562 516_NOLC1_K562 522_HLTF_K562 530_RPS3_K562 537_AGGF1_K562 540_RPS3_HepG2 543_AGGF1_HepG2 544_DKC1_HepG2 545_EIF3H_HepG2 546_NKRF_HepG2 548_ZRANB2_K562 550_DDX55_K562 551_YBX3_K562 553_NOLC1_HepG2 556_CDC40_HepG2 558_LARP4_HepG2 560_HNRNPL_K562 565_NIPBL_K562 566_NCBP2_K562 570_ZNF622_K562 571_FUBP3_HepG2 572_CSTF2_HepG2 575_DROSHA_HepG2 577_DDX6_K562 582_EFTUD2_K562 584_TBRG4_K562 586_DDX51_K562 589_DDX6_HepG2 592_LSM11_HepG2 595_DDX55_HepG2 602_WDR43_HepG2 603_DDX59_HepG2 610_UCHL5_K562 614_RPS11_K562 617_TBRG4_HepG2 621_UTP18_HepG2 625_EIF3D_HepG2 628_GRWD1_HepG2 631_EFTUD2_HepG2 641_ZC3H11A_HepG2 642_DDX52_HepG2 643_BCLAF1_HepG2 645_GRWD1_K562 646_EIF3G_K562 649_FASTKD2_HepG2 650_SUPV3L1_HepG2 651_HLTF_HepG2 652_SUGP2_HepG2 654_DHX30_HepG2 655_XPO5_HepG2 663_SUPV3L1_K562 668_PUS1_K562 670_AQR_K562 676_RBFOX2_K562 677_GEMIN5_K562 678_HNRNPL_HepG2 680_PHF6_K562 681_DDX52_K562 682_DHX30_K562 683_ZC3H8_K562 684_ZC3H11A_K562 686_UTP18_K562 689_FUS_K562 690_PUM1_K562 692_PCBP1_HepG2 693_SERBP1_K562 694_FUS_HepG2 695_MATR3_HepG2 696_PTBP1_HepG2 697_AKAP1_K562 699_HNRNPC_K562 703_NIP7_HepG2 708_AKAP1_HepG2 712_G3BP1_HepG2 713_FXR2_HepG2 716_MATR3_K562 719_PCBP1_K562 722reseq2_EXOSC5_HepG2 723reseq1_FTO_HepG2 726_UPF1_HepG2 729_YBX3_HepG2 730_SSB_HepG2 734_ABCF1_K562 737_ZNF800_K562 738_SSB_K562 740_SDAD1_K562 743_ZNF800_HepG2 744_SDAD1_HepG2 750_PABPN1_HepG2 752_PRPF4_HepG2 753_TIAL1_HepG2 755_KHSRP_HepG2 762_AQR_HepG2 374x4000fix_APOBEC3C_K562 632x_SUB1_HepG2)


name=${names[$PBS_ARRAYID]}



outdir=/home/hsher/encore_region_shrink/


rep1name=$name.rep1
rep2name=$name.rep2

echo $name

fullpathrep1=$outdir$rep1name
fullpathrep2=$outdir$rep2name


#python /home/hsher/Metadensity/scripts/evaluate_dbscan_clusters.py $fullpathrep1.pickle $fullpathrep1.ctrl.pickle $kmerdir
#python /home/hsher/Metadensity/scripts/evaluate_dbscan_clusters.py $fullpathrep2.pickle $fullpathrep2.ctrl.pickle $kmerdir

conda activate rbpamp
kmerdir=/home/hsher/dbclus_motif/
python /home/hsher/Metadensity/scripts/rbpamp_kmer.py $kmerdir/$rep1name.8mer.csv
python /home/hsher/Metadensity/scripts/rbpamp_kmer.py $kmerdir/$rep2name.8mer.csv
