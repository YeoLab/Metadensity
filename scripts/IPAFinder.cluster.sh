#!/bin/bash
#PBS -q home-yeo
#PBS -N ENCODE_ipafinder
#PBS -l nodes=1:ppn=6
#PBS -l walltime=48:00:00
#PBS -o /home/hsher/cluster_msg/ipafinder.out
#PBS -e /home/hsher/cluster_msg/ipafinder.err
#PBS -t 0-221
source ~/miniconda3/etc/profile.d/conda.sh
basedir=/projects/ps-yeolab5/encode/rnaseq/shrna_knockdown/
# genereate config file
outdir=~/IPAfinder_out/

bamones=(ENCFF499WOR ENCFF767VDD ENCFF446FTR ENCFF158ITX ENCFF630LXE ENCFF725YFX ENCFF751ITZ ENCFF225TRZ ENCFF207XGV ENCFF449HAZ ENCFF843KJF ENCFF151ZEL ENCFF332CHF ENCFF412TXK ENCFF273IEO ENCFF373FWY ENCFF279PQZ ENCFF276IWT ENCFF959WPL ENCFF387QCB ENCFF036KPI ENCFF572PAW ENCFF214KGP ENCFF268SDJ ENCFF870KFE ENCFF839QHL ENCFF253KKR ENCFF198FDG ENCFF812AEQ ENCFF372AFS ENCFF069VOQ ENCFF875ZVH ENCFF891JDX ENCFF171YKW ENCFF930DYT ENCFF592JWO ENCFF985QNQ ENCFF857MUO ENCFF132SHU ENCFF103VZY ENCFF688ORJ ENCFF764AHF ENCFF411JUJ ENCFF970LKG ENCFF422YHM ENCFF491XQX ENCFF407RUC ENCFF256VYT ENCFF503HFA ENCFF131YVK ENCFF789VGM ENCFF262RSX ENCFF652GWU ENCFF842IDK ENCFF752MBC ENCFF130KNV ENCFF731UBI ENCFF516WEP ENCFF918BEC ENCFF271ZYT ENCFF820TIZ ENCFF935TXK ENCFF203WMA ENCFF588RXP ENCFF465XUK ENCFF919UOJ ENCFF601NJD ENCFF481NZE ENCFF203SIQ ENCFF550PNU ENCFF566LUZ ENCFF974PYS ENCFF684CIL ENCFF173FEQ ENCFF390MIX ENCFF772JIO ENCFF269ZVZ ENCFF905QOO ENCFF020FNS ENCFF459YCM ENCFF371SPX ENCFF362TLS ENCFF289HFR ENCFF132IOH ENCFF101CJL ENCFF888UOD ENCFF109OEF ENCFF368DPO ENCFF323ZKA ENCFF467QHA ENCFF577OGZ ENCFF508UPR ENCFF215QMS ENCFF995EQN ENCFF197QFK ENCFF058VTG ENCFF046ENG ENCFF734FHW ENCFF742IUO ENCFF436PXG ENCFF514OEF ENCFF015RWL ENCFF986NRO ENCFF816RGM ENCFF877VVK ENCFF259ZYJ ENCFF611CLD ENCFF121NYE ENCFF990XDZ ENCFF935KUC ENCFF664UFG ENCFF997NWS ENCFF686LKD ENCFF400VDZ ENCFF640DZK ENCFF651OSW ENCFF377ZTK ENCFF870COS ENCFF780LYQ ENCFF550XIC ENCFF988HCD ENCFF466BYB ENCFF764KJW ENCFF562SON ENCFF085XBF ENCFF328GAZ ENCFF584IWV ENCFF732FSX ENCFF340UFH ENCFF072KAU ENCFF079UCH ENCFF222CYM ENCFF086DTK ENCFF867FKK ENCFF383DKD ENCFF611HGV ENCFF253RJD ENCFF716YLR ENCFF587KKY ENCFF114TIS ENCFF391OCV ENCFF415JWM ENCFF861NSL ENCFF633QJY ENCFF118JRL ENCFF721JAR ENCFF326BPV ENCFF454VQW ENCFF256UVZ ENCFF771AHF ENCFF829HUU ENCFF111NRZ ENCFF151DJX ENCFF741NGC ENCFF507LJA ENCFF631HEW ENCFF984MME ENCFF193YBH ENCFF295CFK ENCFF002RWS ENCFF369XSP ENCFF067WKG ENCFF324GVC ENCFF366TBR ENCFF512KLH ENCFF512ELZ ENCFF567ICO ENCFF555VXW ENCFF380OYY ENCFF516KCI ENCFF810PHY ENCFF606AVE ENCFF071RFP ENCFF554QEV ENCFF211VLH ENCFF460YJY ENCFF921YDI ENCFF927NOX ENCFF044SSS ENCFF662XNN ENCFF359ZQU ENCFF361YGH ENCFF997NRL ENCFF652UUW ENCFF325KNC ENCFF053OCI ENCFF670LRD ENCFF876ERJ ENCFF171TTJ ENCFF627EBI ENCFF363ASO ENCFF968MUN ENCFF357UJY ENCFF842XKM ENCFF553NAO ENCFF673GAB ENCFF350YQV ENCFF957TLS ENCFF191YTI ENCFF633EDM ENCFF218ZII ENCFF135URE ENCFF031KTB ENCFF234KAR ENCFF921OOX ENCFF708QSG ENCFF321DPA ENCFF988EGT ENCFF822DIA ENCFF601RTZ ENCFF052YSS ENCFF296IYJ ENCFF650ZEJ ENCFF407ZEZ ENCFF771TRQ ENCFF890QDC ENCFF415ANM ENCFF714WXH ENCFF917QUS ENCFF420XAQ ENCFF995JDI ENCFF520WPX)

bamtwos=(ENCFF008OKN ENCFF039EFY ENCFF063DVX ENCFF655GRA ENCFF533VDU ENCFF543EPJ ENCFF912FLN ENCFF989TMS ENCFF796SGY ENCFF392HZK ENCFF624NBF ENCFF889ZJT ENCFF451TLM ENCFF994UAY ENCFF404KTE ENCFF370FDT ENCFF924TTV ENCFF519FBY ENCFF782WLK ENCFF246LZZ ENCFF964OHS ENCFF044OKC ENCFF373KKN ENCFF208TBN ENCFF755BAZ ENCFF494QFX ENCFF627XRL ENCFF568KAD ENCFF906CAC ENCFF871MMC ENCFF827WGG ENCFF288ZFC ENCFF181APT ENCFF101BJR ENCFF955KYN ENCFF744GRY ENCFF968NXH ENCFF610AAZ ENCFF295YGW ENCFF452EMG ENCFF167HPP ENCFF609FZS ENCFF902TQC ENCFF427FYZ ENCFF471PNG ENCFF998XFR ENCFF809ILK ENCFF217XPV ENCFF946NGE ENCFF008LKR ENCFF949OZH ENCFF331PYA ENCFF038NBJ ENCFF813JIZ ENCFF876NAI ENCFF428OGQ ENCFF247CLK ENCFF874HKS ENCFF656YKZ ENCFF574CEC ENCFF894TVP ENCFF505IWI ENCFF713ZMQ ENCFF466EVT ENCFF134ZUW ENCFF087WDY ENCFF741FHY ENCFF672FGY ENCFF098IMS ENCFF224UNS ENCFF367YRD ENCFF778AZZ ENCFF902IHE ENCFF437QEA ENCFF744WGZ ENCFF940WWC ENCFF307SBE ENCFF009MBZ ENCFF901EGK ENCFF541IMJ ENCFF393LTX ENCFF202TKA ENCFF008OMX ENCFF956IBX ENCFF309RQX ENCFF311VYO ENCFF414CZS ENCFF878DWG ENCFF045DRT ENCFF051CAG ENCFF920TDC ENCFF101YXQ ENCFF591AHP ENCFF647IUR ENCFF060VSE ENCFF150DQE ENCFF687AGZ ENCFF156XKW ENCFF206UTF ENCFF361LGV ENCFF771HJQ ENCFF487HDO ENCFF904USC ENCFF202DAN ENCFF694DXD ENCFF061UBO ENCFF930UIK ENCFF558WTK ENCFF016KQV ENCFF044JDG ENCFF633KFU ENCFF934NGG ENCFF153VYI ENCFF829SXA ENCFF730PVD ENCFF020ATL ENCFF897XWY ENCFF111AGW ENCFF882KNZ ENCFF255SHL ENCFF682XUU ENCFF396QZZ ENCFF349HFT ENCFF994KLD ENCFF124XRR ENCFF275GXI ENCFF040XPE ENCFF448BMO ENCFF152SSV ENCFF623UWZ ENCFF911NYK ENCFF907YWP ENCFF462NSJ ENCFF102THE ENCFF466CKO ENCFF233YFQ ENCFF350AXZ ENCFF315XSA ENCFF686SLR ENCFF392KBU ENCFF847YMN ENCFF221RXA ENCFF158TJL ENCFF541QPD ENCFF161LUA ENCFF236UHC ENCFF638JCM ENCFF761YCL ENCFF183AHH ENCFF823IDH ENCFF799YPD ENCFF864WXU ENCFF852HQQ ENCFF018TYT ENCFF079AYK ENCFF592GCC ENCFF740UYB ENCFF780OXE ENCFF933YGM ENCFF619EBQ ENCFF036OHN ENCFF285BET ENCFF743XCK ENCFF665RGY ENCFF476KOE ENCFF695SSC ENCFF564RGD ENCFF533SIN ENCFF351XXC ENCFF752QBE ENCFF534VDO ENCFF956DKX ENCFF103RQT ENCFF632KHF ENCFF810CQZ ENCFF792AUU ENCFF818BNM ENCFF658DCV ENCFF309MRQ ENCFF747RMM ENCFF309PCT ENCFF722ZUO ENCFF081JHI ENCFF727PTE ENCFF082JJQ ENCFF744KGM ENCFF581FAG ENCFF345BJV ENCFF451WIR ENCFF003KXY ENCFF589LNN ENCFF782MDE ENCFF039VBF ENCFF139IFY ENCFF676JGE ENCFF605AHY ENCFF432OJL ENCFF370DLR nan ENCFF810MHB ENCFF350NSR ENCFF833WEC ENCFF519CYF ENCFF285ELE ENCFF798RSV ENCFF883PJY ENCFF642JIT ENCFF252LJU ENCFF591RQE ENCFF762BSV ENCFF004ORO ENCFF094DSM ENCFF431LMX ENCFF387TRG ENCFF644FZX ENCFF092OSB ENCFF006DJB ENCFF178PGE ENCFF920LKB ENCFF189WJH ENCFF068LRE ENCFF944XRF)

ctrlones=(ENCFF958NOA ENCFF839SZZ ENCFF232HCC ENCFF396YDD ENCFF086SXC ENCFF232HCC ENCFF925CTT ENCFF124BQH ENCFF376WQN ENCFF212WWN ENCFF176FHW ENCFF212WWN ENCFF958NOA ENCFF074QTM ENCFF124BQH ENCFF124BQH ENCFF376WQN ENCFF808WAQ ENCFF928FXN ENCFF964NLY ENCFF176FHW ENCFF958NOA ENCFF958NOA ENCFF839SZZ ENCFF232HCC ENCFF456VWU ENCFF583JDB ENCFF396YDD ENCFF590QAL ENCFF456VWU ENCFF694JWV ENCFF376WQN ENCFF155ZJN ENCFF665OLB ENCFF371TBZ ENCFF232HCC ENCFF880DNL ENCFF925CTT ENCFF078LXU ENCFF928FXN ENCFF519WJE ENCFF078LXU ENCFF456VWU ENCFF074QTM ENCFF529TIM ENCFF232HCC ENCFF289WRI ENCFF456VWU ENCFF396YDD ENCFF232HCC ENCFF124BQH ENCFF839SZZ ENCFF808WAQ ENCFF958NOA ENCFF074QTM ENCFF925CTT ENCFF124BQH ENCFF549AUI ENCFF694JWV ENCFF549AUI ENCFF086SXC ENCFF212WWN ENCFF665OLB ENCFF212WWN ENCFF212WWN ENCFF289TTH ENCFF176FHW ENCFF568DGW ENCFF078LXU ENCFF232HCC ENCFF185IAD ENCFF948LBQ ENCFF519WJE ENCFF176FHW ENCFF026SLE ENCFF456VWU ENCFF994YDH ENCFF396YDD ENCFF568DGW ENCFF583JDB ENCFF095ZAS ENCFF948LBQ ENCFF529TIM ENCFF665OLB ENCFF456VWU ENCFF665OLB ENCFF928FXN ENCFF376WQN ENCFF111LSY ENCFF289TTH ENCFF948LBQ ENCFF556NPQ ENCFF549AUI ENCFF808WAQ ENCFF808WAQ ENCFF176FHW ENCFF958NOA ENCFF310OHO ENCFF529TIM ENCFF289WRI ENCFF636FCJ ENCFF396YDD ENCFF396YDD ENCFF289WRI ENCFF124BQH ENCFF694JWV ENCFF556NPQ ENCFF568DGW ENCFF556NPQ ENCFF568DGW ENCFF964NLY ENCFF185IAD ENCFF026SLE ENCFF420VMT ENCFF232HCC ENCFF078LXU ENCFF078LXU ENCFF636FCJ ENCFF583JDB ENCFF185IAD ENCFF124BQH ENCFF212WWN ENCFF176FHW ENCFF289WRI ENCFF289WRI ENCFF925CTT ENCFF371TBZ ENCFF694JWV ENCFF456VWU ENCFF568DGW ENCFF185IAD ENCFF958NOA ENCFF768YMX ENCFF377TXZ ENCFF568DGW ENCFF568DGW ENCFF925CTT ENCFF371TBZ ENCFF925CTT ENCFF925CTT ENCFF232HCC ENCFF839SZZ ENCFF549AUI ENCFF636FCJ ENCFF665OLB ENCFF665OLB ENCFF420VMT ENCFF420VMT ENCFF529TIM ENCFF420VMT ENCFF958NOA ENCFF371TBZ ENCFF078LXU ENCFF376WQN ENCFF376WQN ENCFF928FXN ENCFF095ZAS ENCFF095ZAS ENCFF964NLY ENCFF176FHW ENCFF371TBZ ENCFF549AUI ENCFF549AUI ENCFF928FXN ENCFF176FHW ENCFF289TTH ENCFF026SLE ENCFF074QTM ENCFF124BQH ENCFF694JWV ENCFF232HCC ENCFF768YMX ENCFF583JDB ENCFF376WQN ENCFF964NLY ENCFF185IAD ENCFF176FHW ENCFF839SZZ ENCFF124BQH ENCFF456VWU ENCFF124BQH ENCFF086SXC ENCFF948LBQ ENCFF925CTT ENCFF420VMT ENCFF396YDD ENCFF549AUI ENCFF568DGW ENCFF549AUI ENCFF058KYW ENCFF396YDD ENCFF420VMT ENCFF232HCC ENCFF925CTT ENCFF556NPQ ENCFF396YDD ENCFF568DGW ENCFF289WRI ENCFF074QTM ENCFF583JDB ENCFF376WQN ENCFF095ZAS ENCFF289WRI ENCFF289WRI ENCFF958NOA ENCFF371TBZ ENCFF958NOA ENCFF925CTT ENCFF232HCC ENCFF894EOF ENCFF583JDB ENCFF808WAQ ENCFF185IAD ENCFF074QTM ENCFF958NOA ENCFF925CTT ENCFF636FCJ ENCFF556NPQ ENCFF636FCJ ENCFF964NLY ENCFF958NOA ENCFF964NLY)

ctrltwos=(ENCFF202ZWS ENCFF161EYD ENCFF979BGR ENCFF867NHV ENCFF652TWL ENCFF979BGR ENCFF360UZH ENCFF311TMC ENCFF231QDM ENCFF698JGB ENCFF122VBO ENCFF698JGB ENCFF202ZWS ENCFF046OMI ENCFF311TMC ENCFF311TMC ENCFF231QDM ENCFF181IAL ENCFF279WLO ENCFF359FKE ENCFF122VBO ENCFF202ZWS ENCFF202ZWS ENCFF161EYD ENCFF979BGR ENCFF565WRF ENCFF816LBP ENCFF867NHV ENCFF286MAR ENCFF565WRF ENCFF902YHV ENCFF231QDM ENCFF601IUN ENCFF615KJS ENCFF403KGR ENCFF979BGR ENCFF617TFJ ENCFF360UZH ENCFF669EEP ENCFF279WLO ENCFF272FNP ENCFF669EEP ENCFF565WRF ENCFF046OMI ENCFF361KUQ ENCFF979BGR ENCFF197UJB ENCFF565WRF ENCFF867NHV ENCFF979BGR ENCFF311TMC ENCFF161EYD ENCFF181IAL ENCFF202ZWS ENCFF046OMI ENCFF360UZH ENCFF311TMC ENCFF761SAC ENCFF902YHV ENCFF761SAC ENCFF652TWL ENCFF698JGB ENCFF615KJS ENCFF698JGB ENCFF698JGB ENCFF284NQQ ENCFF122VBO ENCFF691JCT ENCFF669EEP ENCFF979BGR ENCFF021NQD ENCFF634HKB ENCFF272FNP ENCFF122VBO ENCFF954ZEF ENCFF565WRF ENCFF574REP ENCFF867NHV ENCFF691JCT ENCFF816LBP ENCFF782JJL ENCFF634HKB ENCFF361KUQ ENCFF615KJS ENCFF565WRF ENCFF615KJS ENCFF279WLO ENCFF231QDM ENCFF014TBH ENCFF284NQQ ENCFF634HKB ENCFF598ZGR ENCFF761SAC ENCFF181IAL ENCFF181IAL ENCFF122VBO ENCFF202ZWS ENCFF743GZQ ENCFF361KUQ ENCFF197UJB ENCFF936ZIY ENCFF867NHV ENCFF867NHV ENCFF197UJB ENCFF311TMC ENCFF902YHV ENCFF598ZGR ENCFF691JCT ENCFF598ZGR ENCFF691JCT ENCFF359FKE ENCFF021NQD ENCFF954ZEF ENCFF501COM ENCFF979BGR ENCFF669EEP ENCFF669EEP ENCFF936ZIY ENCFF816LBP ENCFF021NQD ENCFF311TMC ENCFF698JGB ENCFF122VBO ENCFF197UJB ENCFF197UJB ENCFF360UZH ENCFF403KGR ENCFF902YHV ENCFF565WRF ENCFF691JCT ENCFF021NQD ENCFF202ZWS ENCFF507BXE ENCFF170JPI ENCFF691JCT ENCFF691JCT ENCFF360UZH ENCFF403KGR ENCFF360UZH ENCFF360UZH ENCFF979BGR ENCFF161EYD ENCFF761SAC ENCFF936ZIY ENCFF615KJS ENCFF615KJS ENCFF501COM ENCFF501COM ENCFF361KUQ ENCFF501COM ENCFF202ZWS ENCFF403KGR ENCFF669EEP ENCFF231QDM ENCFF231QDM ENCFF279WLO ENCFF782JJL ENCFF782JJL ENCFF359FKE ENCFF122VBO ENCFF403KGR ENCFF761SAC ENCFF761SAC ENCFF279WLO ENCFF122VBO ENCFF284NQQ ENCFF954ZEF ENCFF046OMI ENCFF311TMC ENCFF902YHV ENCFF979BGR ENCFF507BXE ENCFF816LBP ENCFF231QDM ENCFF359FKE ENCFF021NQD ENCFF122VBO ENCFF161EYD ENCFF311TMC ENCFF565WRF ENCFF311TMC ENCFF652TWL ENCFF634HKB ENCFF360UZH ENCFF501COM ENCFF867NHV ENCFF761SAC ENCFF691JCT ENCFF761SAC ENCFF392PRG ENCFF867NHV ENCFF501COM ENCFF979BGR ENCFF360UZH ENCFF598ZGR ENCFF867NHV ENCFF691JCT ENCFF197UJB ENCFF046OMI ENCFF816LBP ENCFF231QDM ENCFF782JJL ENCFF197UJB ENCFF197UJB ENCFF202ZWS ENCFF403KGR ENCFF202ZWS ENCFF360UZH ENCFF979BGR ENCFF076OKU ENCFF816LBP ENCFF181IAL ENCFF021NQD ENCFF046OMI ENCFF202ZWS ENCFF360UZH ENCFF936ZIY ENCFF598ZGR ENCFF936ZIY ENCFF359FKE ENCFF202ZWS ENCFF359FKE)

accessions=(ENCSR529QEZ ENCSR408SDL ENCSR105OXX ENCSR629EWX ENCSR031RZS ENCSR222SMI ENCSR478FJK ENCSR309PPC ENCSR110HAA ENCSR788YGG ENCSR995RPB ENCSR192GBD ENCSR732IYM ENCSR631RFX ENCSR312SRB ENCSR210KJB ENCSR594DNW ENCSR721MXZ ENCSR689MIY ENCSR843LYF ENCSR547NWD ENCSR997FOT ENCSR318HAT ENCSR783YSQ ENCSR116YMU ENCSR477TRX ENCSR732ICL ENCSR906RHU ENCSR496ETJ ENCSR620OKS ENCSR330YOU ENCSR610VTA ENCSR060KRD ENCSR101OPF ENCSR459EMR ENCSR927SLP ENCSR958KSY ENCSR861ENA ENCSR246SOU ENCSR269ZAO ENCSR795VAK ENCSR904CJQ ENCSR992JGE ENCSR334BTA ENCSR244SIO ENCSR237IWZ ENCSR004OSI ENCSR820ROH ENCSR134JRE ENCSR706SXN ENCSR891DYO ENCSR007XKL ENCSR529MBZ ENCSR398LZW ENCSR341PZW ENCSR710NWE ENCSR398GHW ENCSR306EIU ENCSR635FRH ENCSR079LMZ ENCSR936TED ENCSR552NBS ENCSR227AVS ENCSR126ARZ ENCSR954HAY ENCSR153GKS ENCSR167JPY ENCSR634KBO ENCSR079IPT ENCSR082YGI ENCSR376FGR ENCSR782MXN ENCSR563YIS ENCSR471GIS ENCSR835RMN ENCSR946OFN ENCSR533HXS ENCSR056QEW ENCSR813NZP ENCSR207QGW ENCSR809ISU ENCSR760EGM ENCSR555LCE ENCSR602AWR ENCSR771QMJ ENCSR040FSN ENCSR910ECL ENCSR896MMU ENCSR744PAQ ENCSR840QOH ENCSR003LSA ENCSR361LBE ENCSR222LRL ENCSR077BPR ENCSR746NIM ENCSR222CSF ENCSR500WHE ENCSR395FYF ENCSR967QNT ENCSR052IYH ENCSR004RGI ENCSR527IVX ENCSR952RRH ENCSR309HXK ENCSR137HKS ENCSR148MQK ENCSR000KYM ENCSR770OWW ENCSR067LLB ENCSR599UDS ENCSR794NUE ENCSR527QNC ENCSR076PMZ ENCSR343DHN ENCSR883BXR ENCSR310VND ENCSR256PLH ENCSR234YMW ENCSR495YSS ENCSR629RUG ENCSR911DGK ENCSR082UWF ENCSR639LKS ENCSR104OLN ENCSR070LJO ENCSR850CKU ENCSR810JYX ENCSR057GCF ENCSR788HVK ENCSR598YQX ENCSR925SYZ ENCSR185JGT ENCSR410ZPU ENCSR696JWA ENCSR921KDS ENCSR762FEO ENCSR637JLM ENCSR695XOD ENCSR030ARO ENCSR009PPI ENCSR696LLZ ENCSR188IPO ENCSR258VGD ENCSR143UET ENCSR605MFS ENCSR745WVZ ENCSR942MBU ENCSR784FTX ENCSR047QHX ENCSR880DEH ENCSR995ZGJ ENCSR220TBR ENCSR611ZAL ENCSR713OLV ENCSR060IWW ENCSR518JXY ENCSR494UDF ENCSR281IUF ENCSR844QNT ENCSR347ZHQ ENCSR648BSC ENCSR269HQA ENCSR577OVP ENCSR374NMJ ENCSR573UBF ENCSR278CHI ENCSR898OPN ENCSR454KYR ENCSR398HXV ENCSR597XHH ENCSR838SMC ENCSR584LDM ENCSR239BCO ENCSR124KCF ENCSR530BOP ENCSR389HFU ENCSR570CWH ENCSR286OKW ENCSR660ETT ENCSR656DQV ENCSR029LGJ ENCSR368ZRP ENCSR016XPB ENCSR853ZJS ENCSR012DAF ENCSR302JQA ENCSR336DFS ENCSR392HSJ ENCSR712CSN ENCSR952OOP ENCSR961WVL ENCSR674KDQ ENCSR681SMT ENCSR230ORC ENCSR253DCB ENCSR560AYQ ENCSR322XVS ENCSR693MZJ ENCSR829EFL ENCSR628JYB ENCSR382QKD ENCSR823WTA ENCSR853PBF ENCSR385KOY ENCSR010ZMZ ENCSR781YNI ENCSR410UHJ ENCSR945UYL ENCSR685JXU ENCSR818TZM ENCSR312HJY ENCSR511BNY ENCSR490DYI ENCSR874DVZ ENCSR030GZQ ENCSR074UZM ENCSR325OOM ENCSR780YFF ENCSR232XRZ ENCSR535YPK ENCSR028ITN ENCSR624XHG)


#lengths=(100 100 100 100 100 100 100 100 101 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100)
################## AS replicate ####################


bam1=${bamones[$PBS_ARRAYID]}
bam2=${bamtwos[$PBS_ARRAYID]}
ctrl1=${ctrlones[$PBS_ARRAYID]}
ctrl2=${ctrltwos[$PBS_ARRAYID]}
acc=${accessions[$PBS_ARRAYID]}
#len=${lengths[$PBS_ARRAYID]}


now=$(date)
echo "start running"
echo $now

fullout=$outdir$acc/
mkdir $fullout
config=${fullout}config.txt
touch $config
echo "condition1"=$basedir$bam1.bam,${basedir}$bam2.bam > $config
echo "condition2="$basedir$ctrl1.bam,$basedir$ctrl2.bam >> $config


conda activate IPAfinder
python ~/bin/IPAFinder/IPAFinder_DetectIPA.py -b $config -anno ~/bin/IPAFinder/anno_files/IPAFinder_anno_hg38.txt -p 10 -o ${fullout}IPAFinder_IPUI.txt -e $fullout
conda deactivate

conda activate IPAfinder_R
Rscript ~/bin/IPAFinder/Infer_DUIPA.R -b $config -I ${fullout}IPAFinder_IPUI.txt -d $fullout -o ${fullout}IPAFinder_DUIPA.txt

now=$(date)
echo "end running"
echo $now

# quick look at how many sig event
# for file in  ~/IPAfinder_out/*/IPAFinder_DUIPA.txt ; do echo $file; cat $file | grep -v NOT | grep -v SYMBOL | wc -l; done