#!/bin/bash
#PBS -q home-yeo
#PBS -N DBSCAN_peak
#PBS -l nodes=1:ppn=6
#PBS -l walltime=8:00:00
#PBS -o /home/hsher/cluster_msg/dbscan.out
#PBS -e /home/hsher/cluster_msg/dbscan.err
#PBS -t 0-391

source ~/miniconda3/etc/profile.d/conda.sh
conda activate metadensity


ip_bams=(ENCFF630YNF.bam ENCFF170YQV.bam ENCFF777OWL.bam ENCFF198ISB.bam ENCFF015NHN.bam ENCFF258DPQ.bam ENCFF460TAE.bam ENCFF745EHU.bam ENCFF544NQL.bam ENCFF950RRY.bam ENCFF802VWZ.bam ENCFF050PTL.bam ENCFF904VAH.bam ENCFF201XIY.bam ENCFF483VLR.bam ENCFF690EFW.bam ENCFF693DNX.bam ENCFF159MVB.bam ENCFF106FPU.bam ENCFF936JSP.bam ENCFF476VSU.bam ENCFF132PVT.bam ENCFF794JUI.bam ENCFF876SGL.bam ENCFF025YVA.bam ENCFF396BVL.bam ENCFF751GZQ.bam ENCFF996PFW.bam ENCFF511HSJ.bam ENCFF402QLV.bam ENCFF033XVX.bam ENCFF513VDW.bam ENCFF558FAR.bam ENCFF184QYU.bam ENCFF587PLY.bam ENCFF330OFU.bam ENCFF581EBE.bam ENCFF426AQN.bam ENCFF672HFP.bam ENCFF208OVE.bam ENCFF704TQZ.bam ENCFF418ZXO.bam ENCFF296HGS.bam ENCFF474WKB.bam ENCFF664EPV.bam ENCFF949QUY.bam ENCFF867TFQ.bam ENCFF956ELY.bam ENCFF068KXE.bam ENCFF405ESF.bam ENCFF391IBH.bam ENCFF889XJU.bam ENCFF501PCN.bam ENCFF923ZPC.bam ENCFF023RGT.bam ENCFF985HWL.bam ENCFF110YDG.bam ENCFF547AHN.bam ENCFF343OME.bam ENCFF281FSP.bam ENCFF787ROO.bam ENCFF954XWJ.bam ENCFF372XJQ.bam ENCFF052ORJ.bam ENCFF659RKW.bam ENCFF937IVH.bam ENCFF960NPN.bam ENCFF400HJB.bam ENCFF284RSI.bam ENCFF410PJY.bam ENCFF351ATM.bam ENCFF551NSA.bam ENCFF648KRQ.bam ENCFF526BOW.bam ENCFF857OFG.bam ENCFF394THC.bam ENCFF975NJX.bam ENCFF231WHF.bam ENCFF770DEI.bam ENCFF063MVN.bam ENCFF966HIC.bam ENCFF790KXQ.bam ENCFF278SLD.bam ENCFF666GWV.bam ENCFF948AOR.bam ENCFF012WMS.bam ENCFF732HBQ.bam ENCFF612HAQ.bam ENCFF138FXS.bam ENCFF862YVK.bam ENCFF455DRN.bam ENCFF773TEA.bam ENCFF768FYI.bam ENCFF925JID.bam ENCFF957SIF.bam ENCFF245KXT.bam ENCFF169EKN.bam ENCFF555MNK.bam ENCFF723UHT.bam ENCFF580PEL.bam ENCFF959GNA.bam ENCFF173BOO.bam ENCFF086LQG.bam ENCFF645UGJ.bam ENCFF739LLZ.bam ENCFF102JHG.bam ENCFF057MVG.bam ENCFF830RMG.bam ENCFF604NYA.bam ENCFF959SXJ.bam ENCFF302BJD.bam ENCFF252TQP.bam ENCFF815GWX.bam ENCFF391WTM.bam ENCFF348UPB.bam ENCFF553EAL.bam ENCFF279AVU.bam ENCFF329FPZ.bam ENCFF416LFA.bam ENCFF259KVP.bam ENCFF993XXG.bam ENCFF400EPM.bam ENCFF308LKS.bam ENCFF259ZHT.bam ENCFF149SFF.bam ENCFF399CRA.bam ENCFF401NJF.bam ENCFF242MDU.bam ENCFF703QKL.bam ENCFF259AFA.bam ENCFF931ZGZ.bam ENCFF398FGK.bam ENCFF055MTP.bam ENCFF145NQB.bam ENCFF060BRD.bam ENCFF362KWY.bam ENCFF903GDN.bam ENCFF896PKL.bam ENCFF061HNX.bam ENCFF511WWE.bam ENCFF678TXO.bam ENCFF869UTD.bam ENCFF061QCD.bam ENCFF904WAE.bam ENCFF618EON.bam ENCFF673LOJ.bam ENCFF330PVJ.bam ENCFF605PZM.bam ENCFF307ZHU.bam ENCFF941QMM.bam ENCFF757PDP.bam ENCFF699QMT.bam ENCFF809XHX.bam ENCFF764UJQ.bam ENCFF496FIX.bam ENCFF824TUZ.bam ENCFF436KLO.bam ENCFF537RYR.bam ENCFF072KEM.bam ENCFF607WID.bam ENCFF885ZMH.bam ENCFF729XQQ.bam ENCFF845MNN.bam ENCFF892SVF.bam ENCFF715RSI.bam ENCFF211AAW.bam ENCFF341YQM.bam ENCFF583QFB.bam ENCFF138HUE.bam ENCFF943MCZ.bam ENCFF177YJA.bam ENCFF619UHD.bam ENCFF386UIG.bam ENCFF016YOC.bam ENCFF935AZO.bam ENCFF169ABN.bam ENCFF780HTF.bam ENCFF288LEG.bam ENCFF500VOG.bam ENCFF014KBZ.bam ENCFF345TZP.bam ENCFF405ERW.bam ENCFF040XCG.bam ENCFF699EEF.bam ENCFF560ZTA.bam ENCFF264DBW.bam ENCFF946AMH.bam ENCFF265GVT.bam ENCFF079MBG.bam ENCFF974AOE.bam ENCFF080HMO.bam ENCFF902OZA.bam ENCFF701PJM.bam ENCFF947JHV.bam ENCFF284TAX.bam ENCFF416HFS.bam ENCFF162FHQ.bam ENCFF239CML.bam ENCFF427IMN.bam ENCFF553XCL.bam ENCFF270FPU.bam ENCFF681JJG.bam ENCFF651VGM.bam ENCFF372BZV.bam ENCFF449VXW.bam ENCFF633FLY.bam ENCFF141QHH.bam ENCFF379LZD.bam ENCFF589JKO.bam ENCFF021KOR.bam ENCFF040BYE.bam ENCFF081LVD.bam ENCFF525EHR.bam ENCFF846XXE.bam ENCFF220NDA.bam ENCFF835KXL.bam ENCFF863HRM.bam ENCFF314SWS.bam ENCFF862IYK.bam ENCFF571IRN.bam ENCFF197OBL.bam ENCFF712SXL.bam ENCFF550ZSZ.bam ENCFF626NQT.bam ENCFF218ZEI.bam ENCFF734RGL.bam ENCFF358STL.bam ENCFF859CZM.bam ENCFF987VDX.bam ENCFF499ZKI.bam ENCFF125EPG.bam ENCFF690NVV.bam ENCFF080VML.bam ENCFF523RZH.bam ENCFF205BLM.bam ENCFF562AZL.bam ENCFF889YGM.bam ENCFF867TIG.bam ENCFF655NIG.bam ENCFF438ULK.bam ENCFF696TJG.bam ENCFF830ZKB.bam ENCFF351QXF.bam ENCFF536XVW.bam ENCFF492GWE.bam ENCFF894NKS.bam ENCFF045LAO.bam ENCFF098RFI.bam ENCFF044RGH.bam ENCFF524PYO.bam ENCFF843HDQ.bam ENCFF864GYL.bam ENCFF125BMO.bam ENCFF803QKO.bam ENCFF969SMQ.bam ENCFF635ASG.bam ENCFF778POI.bam ENCFF945CYO.bam ENCFF484XJQ.bam ENCFF186FHG.bam ENCFF765BPN.bam ENCFF149XNS.bam ENCFF414UFZ.bam ENCFF157WNL.bam ENCFF756VXR.bam ENCFF807GZY.bam ENCFF888NYK.bam ENCFF692YDC.bam ENCFF823SYP.bam ENCFF945HNC.bam ENCFF056KWN.bam ENCFF698TGL.bam ENCFF842YPC.bam ENCFF732EQX.bam ENCFF253SPF.bam ENCFF294FZI.bam ENCFF739BZK.bam ENCFF862LPP.bam ENCFF769KHB.bam ENCFF462TDG.bam ENCFF701TPG.bam ENCFF698BKX.bam ENCFF096BLA.bam ENCFF826UUS.bam ENCFF025VQL.bam ENCFF567ADV.bam ENCFF337RLS.bam ENCFF233UZH.bam ENCFF023VLF.bam ENCFF344ZBI.bam ENCFF402KOO.bam ENCFF702XFC.bam ENCFF051SNH.bam ENCFF756NJB.bam ENCFF545KJU.bam ENCFF527CKN.bam ENCFF564ARY.bam ENCFF095KWC.bam ENCFF563BNB.bam ENCFF473EVT.bam ENCFF086HIT.bam ENCFF315OLY.bam ENCFF115CKY.bam ENCFF481DSP.bam ENCFF251DMV.bam ENCFF233HCD.bam ENCFF249CVU.bam ENCFF732TFX.bam ENCFF810ZZO.bam ENCFF144QQC.bam ENCFF588XPN.bam ENCFF162LAM.bam ENCFF184OIG.bam ENCFF405PYI.bam ENCFF770GEL.bam ENCFF202RTW.bam ENCFF775AIE.bam ENCFF532OLG.bam ENCFF913QVA.bam ENCFF934JXI.bam ENCFF836HIK.bam ENCFF616EZQ.bam ENCFF413DZP.bam ENCFF515CUN.bam ENCFF187FER.bam ENCFF273ZJR.bam ENCFF486XDM.bam ENCFF901JSX.bam ENCFF252SPM.bam ENCFF714YUM.bam ENCFF847AOM.bam ENCFF538KWA.bam ENCFF952TJF.bam ENCFF646GUE.bam ENCFF189PHS.bam ENCFF978BQG.bam ENCFF576OQO.bam ENCFF591FGE.bam ENCFF499JDZ.bam ENCFF023GYY.bam ENCFF340WIB.bam ENCFF510PFS.bam ENCFF217MRO.bam ENCFF724QGF.bam ENCFF064QSN.bam ENCFF853HTH.bam ENCFF293ZZT.bam ENCFF600AXE.bam ENCFF705YYZ.bam ENCFF207XKP.bam ENCFF829FDR.bam ENCFF098UHH.bam ENCFF374DAW.bam ENCFF296GDR.bam ENCFF091VCD.bam ENCFF518JBW.bam ENCFF282OCB.bam ENCFF529NNX.bam ENCFF445FRC.bam ENCFF409GUM.bam ENCFF709BYW.bam ENCFF046FNK.bam ENCFF210ZRQ.bam ENCFF064COB.bam ENCFF933ESS.bam ENCFF951GRM.bam ENCFF181DXK.bam ENCFF601NWD.bam ENCFF295MQP.bam ENCFF710RUU.bam ENCFF048BIQ.bam ENCFF216MCK.bam ENCFF127MXD.bam ENCFF395MJO.bam ENCFF157JBC.bam ENCFF162SAS.bam ENCFF041ETC.bam ENCFF216VBT.bam ENCFF385LTB.bam ENCFF811KHK.bam ENCFF148DUH.bam ENCFF343FAD.bam ENCFF113QBT.bam ENCFF474PGR.bam ENCFF346NQQ.bam ENCFF145LAD.bam ENCFF404WOP.bam ENCFF413UKK.bam ENCFF961WNO.bam ENCFF882PEQ.bam ENCFF943EZJ.bam ENCFF228FAK.bam)
input_bams=(ENCFF885KNL.bam ENCFF515BTB.bam ENCFF032OPL.bam ENCFF019JFZ.bam ENCFF655LHZ.bam ENCFF269QNL.bam ENCFF060BMG.bam ENCFF867ISO.bam ENCFF982JPX.bam ENCFF355NYZ.bam ENCFF903KIZ.bam ENCFF532ADX.bam ENCFF819GBX.bam ENCFF596UYR.bam ENCFF072CLZ.bam ENCFF487PQZ.bam ENCFF140QVQ.bam ENCFF068LVA.bam ENCFF378IEN.bam ENCFF227TON.bam ENCFF487BLB.bam ENCFF948OYU.bam ENCFF768FYM.bam ENCFF494XRE.bam ENCFF188FGR.bam ENCFF048VBN.bam ENCFF842FFD.bam ENCFF956SAT.bam ENCFF879UID.bam ENCFF842FRH.bam ENCFF825YLL.bam ENCFF234QSA.bam ENCFF947MAG.bam ENCFF948CVQ.bam ENCFF027WDY.bam ENCFF536WIF.bam ENCFF910OEJ.bam ENCFF019BLW.bam ENCFF818CAZ.bam ENCFF539YZX.bam ENCFF186RBL.bam ENCFF467FPH.bam ENCFF774RKG.bam ENCFF594ZPR.bam ENCFF563VJQ.bam ENCFF047HSP.bam ENCFF438IIB.bam ENCFF635FQJ.bam ENCFF999MGM.bam ENCFF399CEH.bam ENCFF802LNA.bam ENCFF184AQO.bam ENCFF053BXG.bam ENCFF394DDJ.bam ENCFF379FKC.bam ENCFF471ZFP.bam ENCFF263MRM.bam ENCFF190ITO.bam ENCFF057VZS.bam ENCFF600AGC.bam ENCFF931YGS.bam ENCFF062ETM.bam ENCFF651VHA.bam ENCFF114ELO.bam ENCFF791AGL.bam ENCFF294TTP.bam ENCFF883DQC.bam ENCFF962TBZ.bam ENCFF244QMW.bam ENCFF037LUF.bam ENCFF701APQ.bam ENCFF011DYO.bam ENCFF459RGB.bam ENCFF068FML.bam ENCFF949MMS.bam ENCFF405WBU.bam ENCFF810PWF.bam ENCFF786ZZB.bam ENCFF364ZNC.bam ENCFF497KTD.bam ENCFF333OLY.bam ENCFF568SAI.bam ENCFF367FDD.bam ENCFF506OAM.bam ENCFF429YHX.bam ENCFF070RME.bam ENCFF880NLA.bam ENCFF090UAF.bam ENCFF838MYV.bam ENCFF015GLL.bam ENCFF984WTC.bam ENCFF826DXS.bam ENCFF407HUR.bam ENCFF332UNI.bam ENCFF887TNO.bam ENCFF160LFR.bam ENCFF615UKX.bam ENCFF228NIC.bam ENCFF646LJL.bam ENCFF894PGH.bam ENCFF359HHB.bam ENCFF735PKL.bam ENCFF102FKE.bam ENCFF064UJY.bam ENCFF697LPT.bam ENCFF032GIW.bam ENCFF568BOI.bam ENCFF987HHN.bam ENCFF132SLV.bam ENCFF905UMJ.bam ENCFF070DMZ.bam ENCFF038LJH.bam ENCFF204HYV.bam ENCFF273RFL.bam ENCFF824LSN.bam ENCFF252ZZN.bam ENCFF409LAD.bam ENCFF852DRN.bam ENCFF127GEV.bam ENCFF881RZM.bam ENCFF209EIX.bam ENCFF396TYB.bam ENCFF792PAX.bam ENCFF091KVP.bam ENCFF878TBN.bam ENCFF091VTP.bam ENCFF797RXZ.bam ENCFF593SPI.bam ENCFF640KTQ.bam ENCFF083OHX.bam ENCFF224JPZ.bam ENCFF463LHG.bam ENCFF156KLS.bam ENCFF525BGY.bam ENCFF732NGW.bam ENCFF390FNJ.bam ENCFF156WVL.bam ENCFF536KJC.bam ENCFF949QUQ.bam ENCFF444SAJ.bam ENCFF222TZU.bam ENCFF950JUB.bam ENCFF723JLV.bam ENCFF025DXI.bam ENCFF662MYI.bam ENCFF894HGK.bam ENCFF727JVX.bam ENCFF759JDI.bam ENCFF585BNE.bam ENCFF369GNR.bam ENCFF745DZH.bam ENCFF734JUL.bam ENCFF336UXX.bam ENCFF986QCU.bam ENCFF781OKE.bam ENCFF292NQE.bam ENCFF899ROO.bam ENCFF212IIR.bam ENCFF945AUF.bam ENCFF255EGS.bam ENCFF278RGL.bam ENCFF953PIV.bam ENCFF703NSH.bam ENCFF661LGO.bam ENCFF610DOP.bam ENCFF503MUZ.bam ENCFF447LJU.bam ENCFF222HEX.bam ENCFF759UTZ.bam ENCFF166ZIY.bam ENCFF117HXE.bam ENCFF794ILP.bam ENCFF895BNM.bam ENCFF091PQO.bam ENCFF824ZDF.bam ENCFF637GMD.bam ENCFF162VKU.bam ENCFF700YZD.bam ENCFF985TJF.bam ENCFF691TZE.bam ENCFF647AFT.bam ENCFF608WNY.bam ENCFF214XZG.bam ENCFF974NJE.bam ENCFF101VSR.bam ENCFF417RUN.bam ENCFF226CUA.bam ENCFF653PSU.bam ENCFF831VQE.bam ENCFF554TBF.bam ENCFF155TML.bam ENCFF563EHM.bam ENCFF696LDT.bam ENCFF217IZI.bam ENCFF854OMC.bam ENCFF723IPF.bam ENCFF885KNL.bam ENCFF515BTB.bam ENCFF032OPL.bam ENCFF019JFZ.bam ENCFF655LHZ.bam ENCFF269QNL.bam ENCFF060BMG.bam ENCFF867ISO.bam ENCFF982JPX.bam ENCFF355NYZ.bam ENCFF903KIZ.bam ENCFF532ADX.bam ENCFF819GBX.bam ENCFF596UYR.bam ENCFF072CLZ.bam ENCFF487PQZ.bam ENCFF140QVQ.bam ENCFF068LVA.bam ENCFF378IEN.bam ENCFF227TON.bam ENCFF487BLB.bam ENCFF948OYU.bam ENCFF768FYM.bam ENCFF494XRE.bam ENCFF188FGR.bam ENCFF048VBN.bam ENCFF842FFD.bam ENCFF956SAT.bam ENCFF879UID.bam ENCFF842FRH.bam ENCFF825YLL.bam ENCFF234QSA.bam ENCFF947MAG.bam ENCFF948CVQ.bam ENCFF027WDY.bam ENCFF536WIF.bam ENCFF910OEJ.bam ENCFF019BLW.bam ENCFF818CAZ.bam ENCFF539YZX.bam ENCFF186RBL.bam ENCFF467FPH.bam ENCFF774RKG.bam ENCFF594ZPR.bam ENCFF563VJQ.bam ENCFF047HSP.bam ENCFF438IIB.bam ENCFF635FQJ.bam ENCFF999MGM.bam ENCFF399CEH.bam ENCFF802LNA.bam ENCFF184AQO.bam ENCFF053BXG.bam ENCFF394DDJ.bam ENCFF379FKC.bam ENCFF471ZFP.bam ENCFF263MRM.bam ENCFF190ITO.bam ENCFF057VZS.bam ENCFF600AGC.bam ENCFF931YGS.bam ENCFF062ETM.bam ENCFF651VHA.bam ENCFF114ELO.bam ENCFF791AGL.bam ENCFF294TTP.bam ENCFF883DQC.bam ENCFF962TBZ.bam ENCFF244QMW.bam ENCFF037LUF.bam ENCFF701APQ.bam ENCFF011DYO.bam ENCFF459RGB.bam ENCFF068FML.bam ENCFF949MMS.bam ENCFF405WBU.bam ENCFF810PWF.bam ENCFF786ZZB.bam ENCFF364ZNC.bam ENCFF497KTD.bam ENCFF333OLY.bam ENCFF568SAI.bam ENCFF367FDD.bam ENCFF506OAM.bam ENCFF429YHX.bam ENCFF070RME.bam ENCFF880NLA.bam ENCFF090UAF.bam ENCFF838MYV.bam ENCFF015GLL.bam ENCFF984WTC.bam ENCFF826DXS.bam ENCFF407HUR.bam ENCFF332UNI.bam ENCFF887TNO.bam ENCFF160LFR.bam ENCFF615UKX.bam ENCFF228NIC.bam ENCFF646LJL.bam ENCFF894PGH.bam ENCFF359HHB.bam ENCFF735PKL.bam ENCFF102FKE.bam ENCFF064UJY.bam ENCFF697LPT.bam ENCFF032GIW.bam ENCFF568BOI.bam ENCFF987HHN.bam ENCFF132SLV.bam ENCFF905UMJ.bam ENCFF070DMZ.bam ENCFF038LJH.bam ENCFF204HYV.bam ENCFF273RFL.bam ENCFF824LSN.bam ENCFF252ZZN.bam ENCFF409LAD.bam ENCFF852DRN.bam ENCFF127GEV.bam ENCFF881RZM.bam ENCFF209EIX.bam ENCFF396TYB.bam ENCFF792PAX.bam ENCFF091KVP.bam ENCFF878TBN.bam ENCFF091VTP.bam ENCFF797RXZ.bam ENCFF593SPI.bam ENCFF640KTQ.bam ENCFF083OHX.bam ENCFF224JPZ.bam ENCFF463LHG.bam ENCFF156KLS.bam ENCFF525BGY.bam ENCFF732NGW.bam ENCFF390FNJ.bam ENCFF156WVL.bam ENCFF536KJC.bam ENCFF949QUQ.bam ENCFF444SAJ.bam ENCFF222TZU.bam ENCFF950JUB.bam ENCFF723JLV.bam ENCFF025DXI.bam ENCFF662MYI.bam ENCFF894HGK.bam ENCFF727JVX.bam ENCFF759JDI.bam ENCFF585BNE.bam ENCFF369GNR.bam ENCFF745DZH.bam ENCFF734JUL.bam ENCFF336UXX.bam ENCFF986QCU.bam ENCFF781OKE.bam ENCFF292NQE.bam ENCFF899ROO.bam ENCFF212IIR.bam ENCFF945AUF.bam ENCFF255EGS.bam ENCFF278RGL.bam ENCFF953PIV.bam ENCFF703NSH.bam ENCFF661LGO.bam ENCFF610DOP.bam ENCFF503MUZ.bam ENCFF447LJU.bam ENCFF222HEX.bam ENCFF759UTZ.bam ENCFF166ZIY.bam ENCFF117HXE.bam ENCFF794ILP.bam ENCFF895BNM.bam ENCFF091PQO.bam ENCFF824ZDF.bam ENCFF637GMD.bam ENCFF162VKU.bam ENCFF700YZD.bam ENCFF985TJF.bam ENCFF691TZE.bam ENCFF647AFT.bam ENCFF608WNY.bam ENCFF214XZG.bam ENCFF974NJE.bam ENCFF101VSR.bam ENCFF417RUN.bam ENCFF226CUA.bam ENCFF653PSU.bam ENCFF831VQE.bam ENCFF554TBF.bam ENCFF155TML.bam ENCFF563EHM.bam ENCFF696LDT.bam ENCFF217IZI.bam ENCFF854OMC.bam ENCFF723IPF.bam)
names=(203_HNRNPC_HepG2 204_RBFOX2_HepG2 205_IGF2BP1_HepG2 206_HNRNPK_HepG2 211_IGF2BP3_HepG2 215_TIA1_HepG2 216_SRSF9_HepG2 218_TRA2A_HepG2 220_IGF2BP1_K562 222_HNRNPM_HepG2 223_FKBP4_HepG2 224_HNRNPM_K562 226_IGF2BP2_K562 227_SLTM_HepG2 228_SF3B4_HepG2 230_BCCIP_HepG2 236_FMR1_K562 240_TRA2A_K562 241_DDX42_K562 242_U2AF2_K562 243_LARP7_K562 244_U2AF1_K562 245_XRN2_K562 247_HNRNPA1_K562 249_HNRNPU_K562 256_SLTM_K562 258_CPSF6_K562 260_EIF4G2_K562 262_SLBP_K562 267_SAFB2_K562 272_U2AF2_HepG2 275_CSTF2T_K562 278_PRPF8_K562 279_FAM120A_K562 281_HNRNPU_HepG2 283_HNRNPA1_HepG2 285_TIA1_K562 289_HNRNPUL1_K562 291_PRPF8_HepG2 292_CSTF2T_HepG2 297_FAM120A_HepG2 301_SRSF1_HepG2 302_SND1_HepG2 311_XRCC6_HepG2 312_SRSF1_K562 315_FXR1_K562 316_SND1_K562 321_HNRNPUL1_HepG2 325_LIN28B_K562 326_HNRNPK_K562 331_RBM22_K562 338_ILF3_K562 339_TAF15_K562 340_TARDBP_K562 341_DGCR8_K562 342_GTF2F1_K562 344_SMNDC1_HepG2 345_PCBP2_HepG2 350_DDX3X_K562 352_SBDS_K562 353_KHDRBS1_K562 354_NPM1_K562 358_GNL3_K562 367_YWHAG_K562 368_PTBP1_K562 376_SRSF7_K562 383_DGCR8_HepG2 384_GTF2F1_HepG2 387_LIN28B_HepG2 393_SF3A3_HepG2 405_NONO_K562 406_PABPC4_K562 414_PPIL4_K562 416_WRN_K562 437_SFPQ_HepG2 439_KHSRP_K562 440_EWSR1_K562 441_PUM2_K562 445_SMNDC1_K562 447_TROVE2_K562 450_GPKOW_K562 452_NSUN2_K562 460_FASTKD2_K562 464_FTO_K562 465_UPF1_K562 466_QKI_K562 470_MTPAP_K562 475_UTP3_K562 477_NCBP2_HepG2 478_QKI_HepG2 480_XRCC6_K562 481_DROSHA_K562 483_DDX24_K562 491_EXOSC5_K562 492_DDX3X_HepG2 493_ILF3_HepG2 494_RBM22_HepG2 495_PPIG_HepG2 501_RBM5_HepG2 503_TROVE2_HepG2 506_SF3B1_K562 507_SF3B4_K562 508_BUD13_K562 511_AATF_K562 514_RBM15_K562 516_NOLC1_K562 522_HLTF_K562 530_RPS3_K562 537_AGGF1_K562 540_RPS3_HepG2 543_AGGF1_HepG2 544_DKC1_HepG2 545_EIF3H_HepG2 546_NKRF_HepG2 548_ZRANB2_K562 550_DDX55_K562 551_YBX3_K562 553_NOLC1_HepG2 556_CDC40_HepG2 558_LARP4_HepG2 560_HNRNPL_K562 565_NIPBL_K562 566_NCBP2_K562 570_ZNF622_K562 571_FUBP3_HepG2 572_CSTF2_HepG2 575_DROSHA_HepG2 577_DDX6_K562 582_EFTUD2_K562 584_TBRG4_K562 586_DDX51_K562 589_DDX6_HepG2 592_LSM11_HepG2 595_DDX55_HepG2 602_WDR43_HepG2 603_DDX59_HepG2 610_UCHL5_K562 614_RPS11_K562 617_TBRG4_HepG2 621_UTP18_HepG2 625_EIF3D_HepG2 628_GRWD1_HepG2 631_EFTUD2_HepG2 641_ZC3H11A_HepG2 642_DDX52_HepG2 643_BCLAF1_HepG2 645_GRWD1_K562 646_EIF3G_K562 649_FASTKD2_HepG2 650_SUPV3L1_HepG2 651_HLTF_HepG2 652_SUGP2_HepG2 654_DHX30_HepG2 655_XPO5_HepG2 663_SUPV3L1_K562 668_PUS1_K562 670_AQR_K562 676_RBFOX2_K562 677_GEMIN5_K562 678_HNRNPL_HepG2 680_PHF6_K562 681_DDX52_K562 682_DHX30_K562 683_ZC3H8_K562 684_ZC3H11A_K562 686_UTP18_K562 689_FUS_K562 690_PUM1_K562 692_PCBP1_HepG2 693_SERBP1_K562 694_FUS_HepG2 695_MATR3_HepG2 696_PTBP1_HepG2 697_AKAP1_K562 699_HNRNPC_K562 703_NIP7_HepG2 708_AKAP1_HepG2 712_G3BP1_HepG2 713_FXR2_HepG2 716_MATR3_K562 719_PCBP1_K562 722reseq2_EXOSC5_HepG2 723reseq1_FTO_HepG2 726_UPF1_HepG2 729_YBX3_HepG2 730_SSB_HepG2 740_SDAD1_K562 743_ZNF800_HepG2 744_SDAD1_HepG2 750_PABPN1_HepG2 752_PRPF4_HepG2 753_TIAL1_HepG2 755_KHSRP_HepG2 762_AQR_HepG2 374x4000fix_APOBEC3C_K562 632x_SUB1_HepG2 203_HNRNPC_HepG2 204_RBFOX2_HepG2 205_IGF2BP1_HepG2 206_HNRNPK_HepG2 211_IGF2BP3_HepG2 215_TIA1_HepG2 216_SRSF9_HepG2 218_TRA2A_HepG2 220_IGF2BP1_K562 222_HNRNPM_HepG2 223_FKBP4_HepG2 224_HNRNPM_K562 226_IGF2BP2_K562 227_SLTM_HepG2 228_SF3B4_HepG2 230_BCCIP_HepG2 236_FMR1_K562 240_TRA2A_K562 241_DDX42_K562 242_U2AF2_K562 243_LARP7_K562 244_U2AF1_K562 245_XRN2_K562 247_HNRNPA1_K562 249_HNRNPU_K562 256_SLTM_K562 258_CPSF6_K562 260_EIF4G2_K562 262_SLBP_K562 267_SAFB2_K562 272_U2AF2_HepG2 275_CSTF2T_K562 278_PRPF8_K562 279_FAM120A_K562 281_HNRNPU_HepG2 283_HNRNPA1_HepG2 285_TIA1_K562 289_HNRNPUL1_K562 291_PRPF8_HepG2 292_CSTF2T_HepG2 297_FAM120A_HepG2 301_SRSF1_HepG2 302_SND1_HepG2 311_XRCC6_HepG2 312_SRSF1_K562 315_FXR1_K562 316_SND1_K562 321_HNRNPUL1_HepG2 325_LIN28B_K562 326_HNRNPK_K562 331_RBM22_K562 338_ILF3_K562 339_TAF15_K562 340_TARDBP_K562 341_DGCR8_K562 342_GTF2F1_K562 344_SMNDC1_HepG2 345_PCBP2_HepG2 350_DDX3X_K562 352_SBDS_K562 353_KHDRBS1_K562 354_NPM1_K562 358_GNL3_K562 367_YWHAG_K562 368_PTBP1_K562 376_SRSF7_K562 383_DGCR8_HepG2 384_GTF2F1_HepG2 387_LIN28B_HepG2 393_SF3A3_HepG2 405_NONO_K562 406_PABPC4_K562 414_PPIL4_K562 416_WRN_K562 437_SFPQ_HepG2 439_KHSRP_K562 440_EWSR1_K562 441_PUM2_K562 445_SMNDC1_K562 447_TROVE2_K562 450_GPKOW_K562 452_NSUN2_K562 460_FASTKD2_K562 464_FTO_K562 465_UPF1_K562 466_QKI_K562 470_MTPAP_K562 475_UTP3_K562 477_NCBP2_HepG2 478_QKI_HepG2 480_XRCC6_K562 481_DROSHA_K562 483_DDX24_K562 491_EXOSC5_K562 492_DDX3X_HepG2 493_ILF3_HepG2 494_RBM22_HepG2 495_PPIG_HepG2 501_RBM5_HepG2 503_TROVE2_HepG2 506_SF3B1_K562 507_SF3B4_K562 508_BUD13_K562 511_AATF_K562 514_RBM15_K562 516_NOLC1_K562 522_HLTF_K562 530_RPS3_K562 537_AGGF1_K562 540_RPS3_HepG2 543_AGGF1_HepG2 544_DKC1_HepG2 545_EIF3H_HepG2 546_NKRF_HepG2 548_ZRANB2_K562 550_DDX55_K562 551_YBX3_K562 553_NOLC1_HepG2 556_CDC40_HepG2 558_LARP4_HepG2 560_HNRNPL_K562 565_NIPBL_K562 566_NCBP2_K562 570_ZNF622_K562 571_FUBP3_HepG2 572_CSTF2_HepG2 575_DROSHA_HepG2 577_DDX6_K562 582_EFTUD2_K562 584_TBRG4_K562 586_DDX51_K562 589_DDX6_HepG2 592_LSM11_HepG2 595_DDX55_HepG2 602_WDR43_HepG2 603_DDX59_HepG2 610_UCHL5_K562 614_RPS11_K562 617_TBRG4_HepG2 621_UTP18_HepG2 625_EIF3D_HepG2 628_GRWD1_HepG2 631_EFTUD2_HepG2 641_ZC3H11A_HepG2 642_DDX52_HepG2 643_BCLAF1_HepG2 645_GRWD1_K562 646_EIF3G_K562 649_FASTKD2_HepG2 650_SUPV3L1_HepG2 651_HLTF_HepG2 652_SUGP2_HepG2 654_DHX30_HepG2 655_XPO5_HepG2 663_SUPV3L1_K562 668_PUS1_K562 670_AQR_K562 676_RBFOX2_K562 677_GEMIN5_K562 678_HNRNPL_HepG2 680_PHF6_K562 681_DDX52_K562 682_DHX30_K562 683_ZC3H8_K562 684_ZC3H11A_K562 686_UTP18_K562 689_FUS_K562 690_PUM1_K562 692_PCBP1_HepG2 693_SERBP1_K562 694_FUS_HepG2 695_MATR3_HepG2 696_PTBP1_HepG2 697_AKAP1_K562 699_HNRNPC_K562 703_NIP7_HepG2 708_AKAP1_HepG2 712_G3BP1_HepG2 713_FXR2_HepG2 716_MATR3_K562 719_PCBP1_K562 722reseq2_EXOSC5_HepG2 723reseq1_FTO_HepG2 726_UPF1_HepG2 729_YBX3_HepG2 730_SSB_HepG2 740_SDAD1_K562 743_ZNF800_HepG2 744_SDAD1_HepG2 750_PABPN1_HepG2 752_PRPF4_HepG2 753_TIAL1_HepG2 755_KHSRP_HepG2 762_AQR_HepG2 374x4000fix_APOBEC3C_K562 632x_SUB1_HepG2)

ip_bam=${ip_bams[$PBS_ARRAYID]}
input_bam=${input_bams[$PBS_ARRAYID]}
name=${names[$PBS_ARRAYID]}


bamdir=/home/hsher/seqdata/eclip_raw/
tsvdir=/home/hsher/evan_regions/
outdir=/home/hsher/encore_region_shrink/

tsv=$tsvdir$name.tsv


echo $name


python /home/hsher/Metadensity/scripts/shrink_region.py --ip $bamdir$ip_bam --input $bamdir$input_bam --tsv $tsv --out $outdir$name