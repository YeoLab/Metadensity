#!/bin/bash
#PBS -q home-yeo
#PBS -N DBSCAN_peak
#PBS -l nodes=1:ppn=5
#PBS -l walltime=8:00:00
#PBS -o /home/hsher/cluster_msg/dbscan.out
#PBS -e /home/hsher/cluster_msg/dbscan.err
#PBS -t 0-68

ip_bams=(ENCFF162FHQ.bam ENCFF239CML.bam ENCFF681JJG.bam ENCFF651VGM.bam ENCFF372BZV.bam ENCFF846XXE.bam ENCFF571IRN.bam ENCFF197OBL.bam ENCFF125EPG.bam ENCFF690NVV.bam ENCFF080VML.bam ENCFF492GWE.bam ENCFF045LAO.bam ENCFF044RGH.bam ENCFF524PYO.bam ENCFF803QKO.bam ENCFF756VXR.bam ENCFF420FTB.bam ENCFF056KWN.bam ENCFF698TGL.bam ENCFF842YPC.bam ENCFF051SNH.bam ENCFF481DSP.bam ENCFF233HCD.bam ENCFF775AIE.bam ENCFF836HIK.bam ENCFF646GUE.bam ENCFF296GDR.bam ENCFF518JBW.bam ENCFF210ZRQ.bam ENCFF064COB.bam ENCFF181DXK.bam ENCFF048BIQ.bam ENCFF961WNO.bam ENCFF630YNF.bam ENCFF170YQV.bam ENCFF258DPQ.bam ENCFF460TAE.bam ENCFF745EHU.bam ENCFF159MVB.bam ENCFF876SGL.bam ENCFF025YVA.bam ENCFF587PLY.bam ENCFF330OFU.bam ENCFF581EBE.bam ENCFF068KXE.bam ENCFF391IBH.bam ENCFF501PCN.bam ENCFF923ZPC.bam ENCFF547AHN.bam ENCFF284RSI.bam ENCFF701ZSE.bam ENCFF857OFG.bam ENCFF394THC.bam ENCFF975NJX.bam ENCFF169EKN.bam ENCFF830RMG.bam ENCFF959SXJ.bam ENCFF993XXG.bam ENCFF149SFF.bam ENCFF896PKL.bam ENCFF537RYR.bam ENCFF607WID.bam ENCFF341YQM.bam ENCFF583QFB.bam ENCFF177YJA.bam ENCFF935AZO.bam ENCFF701PJM.bam)
input_bams=(ENCFF885KNL.bam ENCFF515BTB.bam ENCFF269QNL.bam ENCFF060BMG.bam ENCFF867ISO.bam ENCFF068LVA.bam ENCFF494XRE.bam ENCFF188FGR.bam ENCFF027WDY.bam ENCFF536WIF.bam ENCFF910OEJ.bam ENCFF999MGM.bam ENCFF802LNA.bam ENCFF053BXG.bam ENCFF394DDJ.bam ENCFF190ITO.bam ENCFF244QMW.bam ENCFF062LCG.bam ENCFF949MMS.bam ENCFF405WBU.bam ENCFF810PWF.bam ENCFF615UKX.bam ENCFF987HHN.bam ENCFF905UMJ.bam ENCFF209EIX.bam ENCFF878TBN.bam ENCFF536KJC.bam ENCFF212IIR.bam ENCFF255EGS.bam ENCFF447LJU.bam ENCFF222HEX.bam ENCFF117HXE.bam ENCFF824ZDF.bam ENCFF696LDT.bam ENCFF885KNL.bam ENCFF515BTB.bam ENCFF269QNL.bam ENCFF060BMG.bam ENCFF867ISO.bam ENCFF068LVA.bam ENCFF494XRE.bam ENCFF188FGR.bam ENCFF027WDY.bam ENCFF536WIF.bam ENCFF910OEJ.bam ENCFF999MGM.bam ENCFF802LNA.bam ENCFF053BXG.bam ENCFF394DDJ.bam ENCFF190ITO.bam ENCFF244QMW.bam ENCFF062LCG.bam ENCFF949MMS.bam ENCFF405WBU.bam ENCFF810PWF.bam ENCFF615UKX.bam ENCFF987HHN.bam ENCFF905UMJ.bam ENCFF209EIX.bam ENCFF878TBN.bam ENCFF536KJC.bam ENCFF212IIR.bam ENCFF255EGS.bam ENCFF447LJU.bam ENCFF222HEX.bam ENCFF117HXE.bam ENCFF824ZDF.bam ENCFF696LDT.bam)
outs=(203_HNRNPC_rep1 204_RBFOX2_rep1 215_TIA1_rep1 216_SRSF9_rep1 218_TRA2A_rep1 240_TRA2A_rep1 247_HNRNPA1_rep1 249_HNRNPU_rep1 281_HNRNPU_rep1 283_HNRNPA1_rep1 285_TIA1_rep1 325_LIN28B_rep1 331_RBM22_rep1 339_TAF15_rep1 340_TARDBP_rep1 345_PCBP2_rep1 387_LIN28B_rep1 388_TAF15_rep1 437_SFPQ_rep1 439_KHSRP_rep1 440_EWSR1_rep1 494_RBM22_rep1 530_RPS3_rep1 540_RPS3_rep1 560_HNRNPL_rep1 571_FUBP3_rep1 614_RPS11_rep1 676_RBFOX2_rep1 678_HNRNPL_rep1 689_FUS_rep1 690_PUM1_rep1 694_FUS_rep1 699_HNRNPC_rep1 755_KHSRP_rep1 203_HNRNPC_rep2 204_RBFOX2_rep2 215_TIA1_rep2 216_SRSF9_rep2 218_TRA2A_rep2 240_TRA2A_rep2 247_HNRNPA1_rep2 249_HNRNPU_rep2 281_HNRNPU_rep2 283_HNRNPA1_rep2 285_TIA1_rep2 325_LIN28B_rep2 331_RBM22_rep2 339_TAF15_rep2 340_TARDBP_rep2 345_PCBP2_rep2 387_LIN28B_rep2 388_TAF15_rep2 437_SFPQ_rep2 439_KHSRP_rep2 440_EWSR1_rep2 494_RBM22_rep2 530_RPS3_rep2 540_RPS3_rep2 560_HNRNPL_rep2 571_FUBP3_rep2 614_RPS11_rep2 676_RBFOX2_rep2 678_HNRNPL_rep2 689_FUS_rep2 690_PUM1_rep2 694_FUS_rep2 699_HNRNPC_rep2 755_KHSRP_rep2)

ip_bam=${ip_bams[$PBS_ARRAYID]}
input_bam=${input_bams[$PBS_ARRAYID]}
out=${outs[$PBS_ARRAYID]}


bamdir=/home/hsher/seqdata/eclip_raw/
beddir=/home/hsher/encore_region_call/
outdir=/home/hsher/encore_region_shrink/

bed=${ip_bam%.*}.bed


echo $bamdir$ip_bam
echo $bamdir$input_bam

python /home/hsher/projects/Metadensity/metadensity/shrink_region.py --ip $bamdir$ip_bam --input $bamdir$input_bam --bed $beddir$bed --out $outdir$out